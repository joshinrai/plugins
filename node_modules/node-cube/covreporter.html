<!DOCTYPE html>
<html>
  <head>
    <title>Coverage</title>
    <script>

headings = [];

onload = function(){
  headings = document.querySelectorAll('h2');
};

onscroll = function(e){
  var heading = find(window.scrollY);
  if (!heading) return;
  var links = document.querySelectorAll('#menu a')
    , link;

  for (var i = 0, len = links.length; i < len; ++i) {
    link = links[i];
    link.className = link.getAttribute('href') == '#' + heading.id
      ? 'active'
      : '';
  }
};

function find(y) {
  var i = headings.length
    , heading;

  while (i--) {
    heading = headings[i];
    if (y >= heading.offsetTop) {
      return heading;
    }
  }
}
</script>

    <style>

body {
  font: 14px/1.6 "Helvetica Neue", Helvetica, Arial, sans-serif;
  margin: 0;
  color: #5d7dad;
  border-top: 2px solid #ddd;
}

#coverage {
  padding: 60px;
}

h1 a {
  color: inherit;
  font-weight: inherit;
}

h1 a:hover {
  text-decoration: none;
}

.onload h1 {
  opacity: 1;
}

h2 {
  width: 80%;
  margin-top: 80px;
  margin-bottom: 0;
  font-weight: 100;
  letter-spacing: 1px;
  border-bottom: 1px solid #eee;
}

a {
  color: #8A6343;
  font-weight: bold;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

ul {
  margin-top: 20px;
  padding: 0 15px;
  width: 100%;
}

ul li {
  float: left;
  width: 40%;
  margin-top: 5px;
  margin-right: 60px;
  list-style: none;
  border-bottom: 1px solid #eee;
  padding: 5px 0;
  font-size: 12px;
}

ul::after {
  content: '.';
  height: 0;
  display: block;
  visibility: hidden;
  clear: both;
}

code {
  font: 12px monaco, monospace;
}

pre {
  margin: 30px;
  padding: 30px;
  border: 1px solid #eee;
  border-bottom-color: #ddd;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 0 10px #eee;
  -moz-box-shadow: inset 0 0 10px #eee;
  box-shadow: inset 0 0 10px #eee;
  overflow-x: auto;
}

img {
  margin: 30px;
  padding: 1px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  -webkit-box-shadow: 0 3px 10px #dedede, 0 1px 5px #888;
  -moz-box-shadow: 0 3px 10px #dedede, 0 1px 5px #888;
  box-shadow: 0 3px 10px #dedede, 0 1px 5px #888;
  max-width: 100%;
}

footer {
  background: #eee;
  width: 100%;
  padding: 50px 0;
  text-align: right;
  border-top: 1px solid #ddd;
}

footer span {
  display: block;
  margin-right: 30px;
  color: #888;
  font-size: 12px;
}

#menu {
  position: fixed;
  width: 220px;
  font-size: 12px;
  overflow-y: auto;
  top: 0;
  right: 0;
  margin: 0;
  height: 100%;
  padding: 15px 0;
  text-align: left;
  border-left: 1px solid #eee;
  -moz-box-shadow: 0 0 2px #888
     , inset 5px 0 20px rgba(0,0,0,.5)
     , inset 5px 0 3px rgba(0,0,0,.3);
  -webkit-box-shadow: 0 0 2px #888
     , inset 5px 0 20px rgba(0,0,0,.5)
     , inset 5px 0 3px rgba(0,0,0,.3);
  box-shadow: 0 0 2px #888
     , inset 5px 0 20px rgba(0,0,0,.5)
     , inset 5px 0 3px rgba(0,0,0,.3);
  -webkit-font-smoothing: antialiased;
  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGYAAABmCAMAAAAOARRQAAABelBMVEUjJSU6OzshIyM5OjoqKy02NjgsLS01NTYjJCUzNTUgISMlJSc0NTUvMDA6PDwlJyg1NjYoKis2NjYrLS02ODkpKyw0NDYrLC04ODovLzA4Ojo0NDUtLy86OjwjIyU4OTosLS82ODgtLS8hIyQvMTEnKCooKSsrKy0qLCwkJSUnKCkrLCwpKiwwMjIxMzMqLC0tLS0pKissLC00NTYwMDIwMTQpKysoKSovMDEtLzA2OTkxMzUrKywvLy8qKyszNTY5OzsqKiw6OjswMDExNDUoKiozNDUvMDIyNDY1Njg2Njk5OTozMzU0NjY4ODkiIyUiIyQ4OTkuMDEmKCowMjQwMTErLS4qKywwMTMhIiMpKiopKy0tLjAkJScxNDQvLzExNDYyNDQmKCk5OTslJig5OjskJSYxMzQrLS8gISIwMTIoKCk1NTUlJSUnJygwMDA4ODgiIiMhISI8PDw6Ojo5OTkpKSojIyQ7OzsyMjIpKSssLCw6Ozw1NjlrfLakAAAg2UlEQVR42jR6i3ea6rYvPgANIAhVXh8WvkQlioUiFlFcBtAmoiRNdzxqu9p0J7vrdK29zuPeex77nnvO/35n1r1ndHRktI0jTOacv/l7lCBK5UqVpOha/YxmWK7BC4TQFKVXrbYsnimqxuuMVlOQ0XltWjUdCwRJ1M+tC1KudOs9q6+da2adUewG0SC0SwELfHtgDds93VEuydEbl3QMWeNoYkR7b/0x1ZRobGI3mLwzAhePqTAwhg6aogjNsGy7/jwQ4rkdqe7CWLxF8k9LfMVFyRS7VJqtkrW8Vt/bkR8FZJao16ipknbC3Yw2lM7laO6HBEOadEZ2tpf65c4v8e3u7FyU6qbiNNyCuzXZ6pawgnwgmrpTT/Q7w2EZmiIJ0dzWDI7mhQ80IfRnMu2kzA5r5r1pIFoia+/d93HRYp1GV8TbrkWoU/+jdI0Ff6yGwTjT1Hn8J+8m1rKpGiYPuNiHnMtNMIv+zpsk84MYTNW1/+DpwXLvckdOCMYowVNPREe0QlM8xRHXXFhcNDzupwsSmb5pH+0t0RP2Qk+QtI7F1Qm6JRC6ZPBtPq/dq/kH+jxtCljn9TIpW6rQIgmSVyj6lPICIw4N/taka41PFUInth0je9+jO6Kt1G4/a7V2LEgG02B0pHVuCZrgltSKMuIl5SyufUv9mYuQi+mFgzbBEtFo2g+Dh4sSTrLNu8JPh00sQydpb00tqXBvqRN7Q7kqzcnIxCGnvZt/WmJacoOEO6Dcn8Qre03pOCSQxbMOXUuDNx9SxuLz4W1I18gvjViQ67zV0rxdWL8Te/TQkuo8STS41DR48W7L6YP2uWIqiUV8rd6Gbf/rnegKZeG8TpAM6afhGze9JAOxbLjsnUXEbrZ9vLYd7MT32cPF5mKKxmjy7huaoD9n62GOxni3iIJwv0IzZAZjdZkUtolCNLVfYZNaquFjGszVVf+J0vrz4CawoKdHnOzb0NMH7CDBOybfYNJ4rfeMyFNjkFYVTzMFs87rnPGXLUOeNKRVc0LnU7/UIgelzsy3CMuth0YfvnY0wsD3vODUL3eJcKqHQpm8yM3XZQWJxO6Un9iYloyyLpOwN2obHy6W6gbpcb44XmyC+mg+itAcaprGcrwZCqMj/GmtKn0zPvpTz/Cv1dw21XwP3cRupg3H3MF/S71eTKj1YrdwKdc2Mw0fRmb2sFf8lW3aU6JbIZSEPqvXvjM7G/aApyXlXeqKfMq0g/Su3rUGJPSPrtGElgknrZM3xUXqsAP6zMCNVn5u8aJnSNpJv2uru7t2jfRziW2+GuhqfldUNbPk71olwo+46ePUo1U3WKk/e5YK07F/wGRgcpODmQnIlVeHCWBE4puBi2jq28UKpqiN1/4UOrGz59TNYrrQHtd+11sG40BGD+pXdelNqGOg4NXe8W4eacJV/NS9/2Umtym6WQqveqR9xdCMElpxnbkalM4Vf9uaEcWZaKdyibEIjWKxJZPN95niCL3GiaXyssIrHxoLkqkzLCXULN46/f2h3tQJgyip+Tk9EAjJ9aJshq7t8X45aowSKspMSvPf7r9R8yxNptIaHS5ozuEm6luPDApugyNP8OaqiQ4BjaequXA54SLC83eHIY2r+CZp4409Xqw8Aa2oI7XkCrQi+in0w5AqF/kLNrcUz+qkl/lAobY1jSnx5OJNhyXIz3qfNFlXc0TKaglNwdWkWYt9QQ1Kr6W8zue21iNrdJk+N5oCr2O9nEtWKC7IS5J/zdDEYrmnAYfg6agCy+qcgz7ZofeDc4PbUWSvkshWuAc7OjiUyLkj+RAtdlwXJcjxdpkTTHDhK8lBCi8+JtvDVL1W6elmOM++YS0LuSlaP1oUvAeiW3cFnvTr8EbTz1tsSMYdGeZe40sRWu5uAfj7q+ZoKv2FNQ0p5XY1lmlcigHZqTPpabufEVrNuNPi165w3uCVQJHyJqmSJ7ZHnguqwtCmwViIJijj04ba2JNYtB+yORf5gg1/9t9iw4vUpeqiunSAbf+IBdj/b+iG2qrHvuNP0Vd/+ThVZT/lrvHYjjgDbbyxaqgHNM2uhxa1GW3UedZYhMMwM4mQhltouK+IV4NdbIQNM+8Yv311RZk9kT4tiYR4LkyFcuPpdcjuhUuFqBAWRZa11lcZ3gEBlXywsNhrt+plISZP5DlsV9l4EgY6J3yZPTUcMrgaWAT3oI79eSbGEbcJpr6BD8kyDiVt+G0/hXosQN4NFXKlfWIfsIs0BHODVok1/IGnKFHJYIquh8Xo+2+bkQNTGgWmN/fZ0Y33LSj6lr1GyV7mWIKg7ZTRZPGuhF/zjRNcQ1UPtSYgnWQxSs0yrVhwNDcdGMNSNe2JT3WuzbAM3HykyAajS3Uphf6STKEqxLas9EnmnhA/lyj9Uj+JoY7SVgVmGLl46Rm2u98sbkap2lzAdKBG4r6LgulQOSSjQv1GWdQ0jtDUK/mAaqM1Uqjpu4k3Rvfvxv7YTxLSK+wN3E5jVIzmF23uZ7hiH/sVP49D7tvoKp4S8b1LuvRlivVB/algbhcFITYVXvDpLzpDfplR2uD5V4XJFxpjmIpLc9Y5sB2TpBRix7Bme6GZIq+06v3XzNeTcA4obQIKxrnT4C2JpOqD92dbmSX8MGazly5EsZVMvSU1f4RZwyu8iQXbVdeLlZrjuTT1jrY1uk5c7iZ7RsvhhluqAkq4JpVQAg7RJFtSu+xgJ8Pv6O1j5DkLxT8mkbfyRW5DrQmG7hiDIjCgBsADbjuof6YHLGeV6a5Q1Smx9joUXPpdaaDx97A/Wq00oJkdR7ZYuQRfS533JtxO1erduqWOYIt3wh0wpbLuCNIYkwxbswbikCUu2CDCS+Q+7rgVtfRcm+SOcdKPRlZ/rE7wNVUEE39KTS5uvUKN1PUnkloPkyzhyGQ8qkouEjJ3H/VXdqG6asSRiw3ecMlBvDDt8dDhBHXMwZ2Cajzjr7/76T+IavqPYvz6r7//E/3X3+N//h/0QozbjPgPiir69P/8X3/9F/yv8b/827/++98WItPu5/Hvwd8YPf5bp/2/lX/T/+Of/0MJ/lYTa+L/Ef+d9vN/3/2T6P/+jyTzu/evf6U7vxN7B6pJkRtAF6jUr8I+P8RsP/ptGhfqFk+pQ/DgAy6NJtRYJdXmp4gK7WLqLKJ+MaKhGjOojvL+SnIWrkpy0SLHDe4QuyNzaEA15mLMCcmE8Em+4HdOihW4/ZWuppJEmzeAwcDtv7MuLc9y2V5atvxXNe3S4DUMt5/Qy2LM9kSYKiVWBuKlfp4nxTntpuW03JbIlkiRvBXmT23g1I2OYe6IizUHPIq6zm6mbfsbteKmi/sg9J+ocQBMctGFO7iljo8TPN+z3jxw4do+ZwfqoR9dkNTKHyM305GpTkfhcHexVkPVGEbUOjuo9f0UMPHBFlGEx0SLvJvVRKTwW7PSew5oPme+E42+frJa9cGt2njS3dK5kIif2eYbhuSEQXEqMVfUjhGIuin0G0/W5ezJyJQy3SpMLai4M0JUWb5u1k9tny5bd1pPwYBpQuDCXZl62xg4CdVEAtflXHs6JKmP/pH6mOl796Lgopj0o8d5kKh00hxG3OSdEE/QBo9Hgr8JJqAeLDwJohG5j/DGh61Rc/+tf22/8kEnxHNCEjo0ElvvGfESZkqmz2BDcKV1H1buSkhkdg7p1IMGs2s17nYjpblrWuE2K9WEO/hcRp5e9oOF/QBmOaDtgil+oaU6szPrdwW65fOB0KUTsVUn7LFU7J8e6cxJIl9+FHw5MQMzuQJ+4oxMH3iW/5GK+hWuG0T+gTLs+fAjdtUd58TmIUq04EeyRCYCjkldow234aIgR5bqwrtZosZ+6YEqAmDqatJ9lWasz4IquKALPtd92hGI3Z2BdzzZue+REl1Om4DIWD+RrtUTOJLI+S0jHowXXdAxsGLSd40zYNuEUlOGhrwL6c7tcOtUOvpJCP7QBQS19H+GvZn05ewjlVLz+IGKoC9TyfQjLMBNmXCuqqtTdOSukZW48B0HqgSTCBrBnlFvF4CG2Su7yFzqmJFURK3UmTT3ru050r0ptUpMilYnBJWfl2Bv6kPlUuE1kxxpdzui9AubsR2N2boVSu81OulAwBqoSr1LZ0LLYOomyZHmjqnXlP72s8LnDouEJjtodBvdHaG1jMySYO7crWd90MpCRyCG14vb5IE7Arupw/y/RcCm/Tm3zK6zYj8PYNaGldiUfkB/LHWcmf2lVM+mwyU27a0qq2tscrQ/vzBjN26DnntIrOyGizzXK35yKQdYnUABkyN4saz3WD/viF+eCcsXnIajdWYJWaYHRstIis9CS+tqnFGmz2j5uzfr3Z4prqgK4XOT/PyftvjZqIm8lhkfxJ7Ol3CJF1piYBGAG8wtAk56Drw1YwmOpcz+NdfkSpSLplRXLXHL0Rquj6YW/gabqgK7Dgr6NwtH0B/AN7XrN+MVJ6AmXmUuqmQulrNNYPmH0RoDogydOKLo/QbfYNARSQQKISRCzRXU+q9WWJFL3LZW6u34CkeG97xC0NNGaJ0bvK6SnZS3zPskr5EtuCgjMWR5o2x5BqhKmDWJPRe7JMEOyRb5uUKlHaGVtq5ivSOaSliSXp9SQm2qk8MRJh10MAp9QQ2H5t59J8rjiwSZtoIfMGjlLPVNdYl/LBR0AO6WLGDmkLkIPRE45Y9MftdAK/yNu1Hn6tzOQTesgQ+8fSzB19wO91vCnO23vOWQdwJ63SJrYjdfKFW6W281PKs2k8iT9ai1cgJ4sa3xqdvmtxR8/+D1B8AKc2u+6JftryRhMWSQtoSBgIyyQGyxcnELuAasXN12oSriU4RMz1DD6RL0TSV+om7i1Yt+jEE/jnawM8cX/UhN4nkiv/w9eALrzNhXuQfOzFL0Fi6SjF7/4Qn8rLYBoa85cvgAnkCEBP+HPbEnquVXCZsMS/yzYw2Vru60P/+nJPYKkzZFjmbykzUoEqV836T5q3fP/L383dF82tx18/AZgZczMAgyeWYKmSZIqtHL+e+O4ZRcq9VI3g/qPeCoiK4pcgEqdbS0S/Be54sbVQOuJVPNBblIghzeasNu7h/g+Sz1IdhI5lCwq1nUb3Ji4OCIcqQZqtqJ5w7rXrg/DA9IgVmEGhDgGecEwnCTHffXcXs0V3OCEVzYDKS1vp/oX+ng+6XVU86UjA6FMO2RXOOOrqY1GgPvrAk9HV/BXtCu5RuwF8qgdGDLsBcui4E33ymdBip1X8uKyhIWT8qNRDsXz+gvO9UiEC0d8RG4Tf2x8H4slljgHtCBcxHLTWOYJm5H/fCPCzOgf9qgOUxTRZ0Pc6ha5yLuLVT9ntvIa6gacE99mCovdUumTQdRP4RPsS9129eEe2uSvvGh0bV4Y3QPPhPZMqhZWSMa5R0Hc1SGO4IVOQc0FrirlibTVfKRrYkD8kz3b+X65/QkUNaZdrdl3mCap0Hf3YcCw/LiouJYNbqz88UqeDYv93yO7vvXtgl4XCyAO4ODkY6W+83+LZU//p3/zXNGGrUKClCiOnL27iJZbNWDF02XXAOeFlB7IaADoMH1Yqr+UP9biyZDEa/iJt4MDeIz6GKTdLVBfWGVtRN4fdT2rgReX8UXwF2zOrradm4J0nyTgdPnai3RvzpZvCKDUqjOwD/QA6EDaMCLewX6QWYVnHY1sx1bd8ovYnPm1ZvPH+rE20lWjOCnZ66/xDt0QAl15FjfBcZp+i9OU0RNPQ0t3x2pSNWo8eiYudwsnuP1Hq6iH1LJCJynkYsfgJ0p3pF6SoQk2l+jqE8CPk+ziGJRSKjs+W5AO185umPdkYzlK4wl7TC9NxyyDP7ZoyYVoXiuS6SjnInlLWrwz1i8bGTKXX0AVQWkSfIlglW3zRJRJ8bg5VgE6ZEnqNu9B++0GNQvDQJvFize4ESNKBJP+8vA3LM4AX5SIBq08Mob+7QMTCZx4nwP/64+4BnlZC+8WtlP/CXw6t1PwMwkJ3jhP1FiXLhDF/3I6FGUzO2DSi9ABxKyyL9paZxSEz40ZCPQToDAJu1959k7QdbVxgB4icsu2s4zsTPJhcEDo+N1GX4zSk/wriRh8AqwL62972i9HJHd1ydaLXVzvKvOfGGw5RVcUVMiKXFH4APdkQU/dc5BX0YfKTNZYXCW9mb8bc8mufoQP6BbdQmT99ZjoYfr/go4TgQX9IDgztim7wyFeGMfbNaeqj8Dzs38pgcqwSv2hbqB3oSGKWKy+sesY7p57wAHldqE6NDudk/W7s/zjrK4rZFlFvaGxnSZdHbc1y47qDN6xkoK8O3bfr2j41dlJZ71rB4dlDqapPFa8N6xBrprUdtenUCHwxKNhw1uuTBh+9uU45k4REpQABN2bAO9DSLqoIL26gNroWgup5pUMxHUNSq4Gyz47vBPvilpo5f9OYI2ddAqTqmnxXERxQJ3UK8fHbVE9HagHi3+tqNRoNsArdmAxHA5LwtQo9ZAaNKUTljnokljo2x8scqVpEEIPc01fPCdHOCg0DeWBz8D5TVAAfx8aRH5X2ZYNI3ebKDZdeJ+oBDAxmRqJ30Eh2/DaeAy5diVNMpEDmXiPDsGTzBLXy8eVDdJoIafgx/gxMyQi454QrW56nCyeELgSuNNEmYkflF+t3CZQOVRWjKhIuCclmQSlAXT3+4JGG75B4t/5hQ+ldMP4LsAW6z3XmU6IJJwpnGVnsgUZhoY1fZlwTR8wSU7xRejf2uCx9Z5trVTRRJP9KnEb134dEieil6eCOGWgboI7xsqsqM99jfJLTePjygKlH2CVxxsse9QRzTBFjD/Kjqitr/CCTBt/SJ6nLxz7cKP9pFqBpp0lN5y+adKNsZjrPuroemZauH9aTTFD3EKHW8S55XBLFQAt1jgxTQCTwxmx/JyfsZDN1RroN3VaxpSenpIX7K+ZbL8VdlQDcI4Cbzg3QJLa9yVqNxUelu+EtxLVqeekaAvSJkO6sSVqbUajxqhKshNpvZqoeApF0k/0P0ikkwUcbdwc4A1ejN7Oo0O15kG7hTMoK3hZRBCX7YYeLW0wvcXx/18n/u37yLgzBYVBUvORGli+sfRcX/74uD6P4hq+7xu54TlWJLFzT63uwUDwuEDdOjJQqx7JV+ZjaEAPi7t0MMrR4Q8Rkf18uxD6RK0RKh0hL8YU+DeL97i4pa5ZSyAfXKwZRS/8gXcxdZXm62RBDj8U3sN8x95b5PpPs/mCBKYvpaA50pN5Ct/499AFTtwQ5vgeSh+NHrKIi4NVpwM/XzRaNfJD856lPE6M21zWPguFsH7jbLVyEDfRmt4VwrhCJ5VTYmcSPfGgO5clfN+vbaDZ7sakU5+2vZ2WCDY031NxJarVytfDDVtiafcTGO2rJ/taoL3zChN2qmjxofczTOYQPPVQPh0JVtYgdUQINcSiNEEy58UdYXX1MpWUCEBx7LbcGtAm8XWRQTVOaoV3ySri4RShhs/B/0m4jX6OAwXOvcA09bNSG4czEGv/Wey6V/jbTCNTW6awXdNTcA1GsPe1E9fZdGl7R0vyoVpIdJtfC6d32NNErrvq/R+d65VG+YOwRXppXxOCYyGNSf1K3x6VxAW/vtz4EC1SgCOSPdN62sLsoIzuDfg8GwZAbquVO8HIuFP/ToVoeUB7nnwMF35a1wK1tI6fkrqFKhQdeJpwyls0pIy8AZde3/6LUUbFaYJthyUJSU/kqDXTLQElnn0Jr4B2RVghNrmNmoEn7pXIeshPguXVsvwoTdmClq49JJU3LWhHyWTrJL9bRP6VKv3tZoA/th77p5Jw++OEENvyvWy/pNeExiDUVQaXIRGh8xySZTI36yueFaSXo1uJY0RnXYgEOoWWOJHeaVuX/bGNhHsh2yinznl/++NJcE9j6fBPRcBdq9hb8awNw8U7Bl6GM7x69EDOIIbX/npZ++amlHR9L/35mE/2Ss4gb0xCcY4VyTFLRE796vHysLAamqcyO+aFQyJIDBNslbH2/MrAvZiSEIedc/cqjmv4fbda2pXbv+F5a2szSsdkm9noiNURXt8edUhGUF6fSZWd1IJaXKFwD+49R6eCXD4Bkef7j9tRtNMVgW8BhRz/Qpy1TmeYk0doyjZoJSbePOReVHgkFsCFuQJ+Lgc4BxeAsK/cOiNDRmdNw0ctYhn/nQ498dYI5znzGLoJi1rav7Cn88rL3wLePVtDK5gl77Tki3gHEsIAQ2+IKgarj7Y8W1IQzV5V9N+0TjLqbg68WfKcOmBCOj3JkwJhVIkwDhc+JorXuZEPMEh0vvH3x7iqf+VAwXgd4diZiaJD1zHL9Snx6Wfg4IugreyhabQkcir+y5XgDtdx3Avs7lkeeCBwDvZoTUCXx5QrZkcEqWfYEiEYRs/EphmRALSNGR1Iclgdr5VFoELpzF4++f35w3/j0t5ucW3n2ch4PQCLuUXupsPRR7UA5FjSKrMtPcKAZJfagO4lGE7FH3YKMjorpK0ZxAv+i2JkJhtAMWWWFej4RhPR/cJ3DxwocCvXDi4SGZU4cu+K32XndiFWgopAl+0GApcwf1XvymJcFs39jExIBO4yUjU9MExBLQYc9H+W7+IgdESPRpciT+rKZPebVtaVq+1GYO/5xTAL3HASjNTGIgMvdjWbgc7JvdE1zIFpuC0U9ESiZyzBixzxWxj4Kwh8My34q+FK3KNLtmsA1qyrmKSNQOXCPUZd+ONelBTvFoUI/CYsqa/RhtKiyMf2CgSFqEPk59Y3uqnlZ8gFpswfSYyko23yVZYxzKGxGm49Zqxg1l8oz5Ra9XaRwHkuxepmgyhm0SoNy2KlbcEqK+9QqS9PNx9Ihm9U7gsR55SSJ1FBDNnkuWKxIZ0SDpXuOGwZdoUbOMDPHP4vBAgz2VlSEJAHZGJVbYIg7l/FO5KfIVvxC8pPPxMGcNMoevFDeStt2iqztE10n2TA4dgJH76YS9HDhKHD3iCx6ieFX84BAI3QQnngh76f5ruPQVbr5qZmck/5UjDc26lfrOvUBWy0Ogl8bCoOkMOns81TnC3cuUS9KW8+9A+fe3XYZOFUPG1u5epSSmDLw0s5s2F0W30ANeo+zJkJQz9SPZgzwYpEoktofhGVfmLOAB20boCbW1QWq/NpET/hnMecw/uSyAH4NJc3ECOU4nnkK1fj3S/i5dwb3R7k00AqQQUwt7Ie1qV0aY/VQX0J8hLPy7eBNXMHYZYDNxHZ2Qh6AuXJxq+AeRec/Q+JLhZV6hpXwQEzw7bf5v9uUf2vpq3qlhmy0IIGTkwYdCfSAFmqbdo+3XvDTDjFJde0mbeQLcn2n31xaAqJ0ixO/CLsT4I4G4DoncVTgRGNBtsCcjISWT+oeXZ4Iedw/8OsJI1aPnNKLX/60VvcZb94uasRxCkqlPQ11u1Sa2hHvB80WQENxVyzjns0/PiEByyil21Te6oisk3mNCEMrhouCFO3yEZTHHOCMy9eb/4Tmi8cVf3Lf7P53SY2hX3PSN033As3ETIMLHWumWEO9JXHA2y2SIBlIPpLGG2qvNsCIlIr+B1SWAqRKm2w6Blf7U+zCSBwJrfHG5i8J5Gax/cVonMlon7aHJX/gSvucIncRP93XCqkv7D8IFKFsLiBgHqUpXhE3pYjEcV1dk/JD9zFVCfEaQIVX8Jmfz7IIofcBKQ4OaG+C3xC2veX9CD+iAFXDNaGg9eTVxvkbJRJlW4Nk9Wk13kn696jWppRDe/8pDrYMO9ZyxZ98ReKSz9kWKLLyk2zCZgAniCkLJVX3n1M9DYbomyahWiv/KixRIV9hj/oFz87I+HLznbPTjpa+D+bZQnMuRsljTpv90vQUt/pK7jCFnA30B/jtroSF2/m/gpWn1aQs5WeA6ghzF8SdqWI20fghdSeDOCSCmLgTkfaGgGDmw7nHFkRzGtag57IHS2na06I+gzEphXo1w/Zx2BM/jKL2nZoFjHggtFQjYi8nSVRSXIE58RPbBObXk7uuIL9+rs/5Zo7suJInEUxgsiZZAWS25iBtpEiZeBgDtghEoAE0sjcayNq85M4tbu/LF5h51335PsGzQ09O875+vUS89lkWMyNOFoip2PuyWyMP/iU2XIZdfCCJNDjebDoBLQdpy7QQZC7s9c0wjHJervQNDu2jWzBW5MSAJMr7bP+Iv92BkS/GGgzjEn7MF1IRKFwwzbjbS4/slGOmhx9cZrFu7HSEefojNv3r0UaKfKOWzXsq1zEugbzlMDFsacRJJI/iJlK3vtkZ+PLZIVMFlKA32wbq2Kd5T0uCLZ1CPkAfCdzkz2EYscjDcZq2AWfziN2covN4kXE1lQXPPLTNM1xx3tbiepcO/t3SWm4w87qfh99SL0ZnY+LKFPLPeXVM2mIIoVWt+9Nk0I7nY4O79iGYqxZ8RVz289an6NVdJWnSKZvJQCAuHNiVaDxPAFoH392t9wot5t0/qmU95eEWNbU2udUW5sN9JVqcYlvAIfLeYC33oUzzxZgSktsv21mA7Uly1FA5VnoJFh6N244Wmv3YJGFv/TCPryaw+ZORlpZjQdq/2DYXr3EZskfed0G61P09ipTKmlTQ1067Rg5+PAk5FlQ9e0SWbGf2B/08kqymOTMVOznsALHHNFH4LFRKl2F/NOiYFl9khNHnSu9Ak5sq26Ynl/i2fdTle29Y1ugqmR5Yj4YT9pvslFyYCbw0mNFr5rVQm1LvkG27QMq9ph3t8fmn6r6SQ4oSbr5tz+J1kIawGzDxb6VYOvvWhobDTXfBeNv3b4aNm5XUinsCGqG2q/45m3+LoCOsddFceYhRx1Tsss9PLdPfJdErFMjYd3gddjiP0+XQjcRadZP6bwNLySvunFf20Czy6JqdEW2a96KxdYdOryBv1BjbuUq2yCHeh+6sk7fGmmPi50pe/1l5TyPe5oHW9oPnhPswLyf2TFDdCyYlhwBCstv5C1HwlW7xWoGT9XZt4qVj5WryLPLLD6h/5cMLEjWzgCeAIKNsLak92aBqBsHl4AJwl2N4jfvbSkBExGimv0nFvv09uDScQbjx+w4kPQjgjlW+g9ws9VEJvI2k8N6XxVu0uIwovgTFdunG24gBtaDi+y1YLQwZ8mwbip5fVlO3k0n0AEr/ETbtu8Vjkm+nNSiEb7X/3fMjBL5A8PdgG+/FnbexbFFExmEfetXAnisEKy5z44WVPpQZjSy/jzeGn4yDRsFGqhh87QPaDBWhlo37IFbe/C0xynS91d2tP/AJoJS0sVF6iwAAAAAElFTkSuQmCC");
}

#menu::after {
  display: block;
  content: '';
  padding-top: 80px;
}

#logo {
  position: fixed;
  bottom: 10px;
  right: 10px;
  background: rgba(255,255,255,.1);
  font-size: 11px;
  display: block;
  width: 20px;
  height: 20px;
  line-height: 20px;
  text-align: center;
  -webkit-border-radius: 20px;
  -moz-border-radius: 20px;
  border-radius: 20px;
  -webkit-box-shadow: 0 0 3px rgba(0,0,0,.2);
  -moz-box-shadow: 0 0 3px rgba(0,0,0,.2);
  box-shadow: 0 0 3px rgba(0,0,0,.2);
  color: inherit;
}

#menu li a {
  display: block;
  color: white;
  padding: 0 35px 0 25px;
  -webkit-transition: background 300ms;
  -moz-transition: background 300ms;
}

#menu li {
  position: relative;
  list-style: none;
}

#menu a:hover,
#menu a.active {
  text-decoration: none;
  background: rgba(255,255,255,.1);
}

#menu li:hover .cov {
  opacity: 1;
}

#menu li .dirname {
  opacity: .60;
  padding-right: 2px;
}

#menu li .basename {
  opacity: 1;
}

#menu .cov {
  background: rgba(230,230,230, 1);
  position: absolute;
  top: 2px;
  right: 8px;
  font-size: 9px;
  opacity: .9;
  text-align: left;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  padding: 1px 2px;
  line-height: 10px;
  text-align: center;
}

#stats:nth-child(2n) {
  display: inline-block;
  margin-top: 15px;
  border: 1px solid #eee;
  padding: 10px;
  -webkit-box-shadow: inset 0 0 2px #eee;
  -moz-box-shadow: inset 0 0 2px #eee;
  box-shadow: inset 0 0 2px #eee;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  border-radius: 5px;
}

#stats div {
  display:inline-block;
  padding: 0 5px;
}

#stats::before {
  content: 'Coverage';
  font-weight:bold;
  color: #aaa;
}
#stats::after {
  display: block;
  content: '';
  clear: both;
}

#stats .sloc::after {
  content: ' SLOC';
  color: #b6b6b6;
}

#stats .linecoverage::before {
  content: 'Line:';
  color: #aaa;
}

#stats .branchcoverage::before {
  content: 'Branch:';
  color: #aaa;
}

#stats .misses:before {
  content: 'miss:';
  color: #aaa;
}

.high {
  color: #5AB75D;
}
.medium {
  color: #e87d0d;
}
.low {
  color: #d4081a;
}
.terrible {
  color: #d4081a;
  font-weight: bold;
}

table {
  width: 80%;
  margin-top: 10px;
  border-collapse: collapse;
  border: 1px solid #cbcbcb;
  color: #363636;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
}

table thead {
  display: none;
}

table td.line,
table td.hits {
  width: 20px;
  background: #eaeaea;
  text-align: center;
  font-size: 11px;
  padding: 0 10px;
  color: #949494;
}

table td.hits {
  width: 10px;
  padding: 2px 5px;
  color: rgba(0,0,0,.2);
  background: #f0f0f0;
}

tr.miss-branch td.line,
tr.miss-branch td.hits {
  background: #FFE5A0;
}

tr.miss td.line,
tr.miss td.hits {
  background: #e6c3c7;
}

tr.miss-branch td{
  background: #FFE5A0;
}
tr.miss td {
  background: #f8d5d8;
}


td.source {
  padding-left: 15px;
  line-height: 15px;
  white-space: pre;
  font: 12px monaco, monospace;
}

code .comment { color: #ddd }
code .init { color: #2F6FAD }
code .string { color: #5890AD }
code .keyword { color: #8A6343 }
code .number { color: #2F6FAD }

i.cond-miss{
  background-color:#F48A24;
  font-style:normal;
  border-radius: 4px;
  padding: 0px 2px;
  color:#fff;
}
</style>
  </head>
  <body>
    <div id="coverage">
      <h1 id="overview">jscoverage reporter</h1>
      <div id="menu">
        <li><a href='#overview'>overview</a></li>
        
        <li>
          <span class="cov medium">
            88
          </span>
          <span class="cov high" style="right: 40px">
            94
          </span>
          <a href="#index.js">
            
            <span class="basename">index.js</span>
          </a>
        </li>
        
        <li>
          <span class="cov low">
            76
          </span>
          <span class="cov high" style="right: 40px">
            100
          </span>
          <a href="#lib/processor_coffee.js">
            
              <span class="dirname">lib/</span>
            
            <span class="basename">processor_coffee.js</span>
          </a>
        </li>
        
        <li>
          <span class="cov medium">
            89
          </span>
          <span class="cov high" style="right: 40px">
            100
          </span>
          <a href="#lib/processor_css.js">
            
              <span class="dirname">lib/</span>
            
            <span class="basename">processor_css.js</span>
          </a>
        </li>
        
        <li>
          <span class="cov high">
            93
          </span>
          <span class="cov high" style="right: 40px">
            100
          </span>
          <a href="#lib/processor_html.js">
            
              <span class="dirname">lib/</span>
            
            <span class="basename">processor_html.js</span>
          </a>
        </li>
        
        <li>
          <span class="cov low">
            78
          </span>
          <span class="cov medium" style="right: 40px">
            86
          </span>
          <a href="#lib/processor_js.js">
            
              <span class="dirname">lib/</span>
            
            <span class="basename">processor_js.js</span>
          </a>
        </li>
        
        <li>
          <span class="cov medium">
            81
          </span>
          <span class="cov terrible" style="right: 40px">
            69
          </span>
          <a href="#lib/utils.js">
            
              <span class="dirname">lib/</span>
            
            <span class="basename">utils.js</span>
          </a>
        </li>
        
        <li>
          <span class="cov high">
            100
          </span>
          <span class="cov high" style="right: 40px">
            100
          </span>
          <a href="#runtime/cube_css.js">
            
              <span class="dirname">runtime/</span>
            
            <span class="basename">cube_css.js</span>
          </a>
        </li>
        
        <li>
          <span class="cov medium">
            86
          </span>
          <span class="cov medium" style="right: 40px">
            80
          </span>
          <a href="#service.js">
            
            <span class="basename">service.js</span>
          </a>
        </li>
        
      </div>

      <div id="stats">
        <div class="linecoverage">
          <span class="linecov high">
            [82.89%]
          </span>
          <span>441/532<span>
          <span class="misses">
            91
          </span>
        </div>
        <div class="branchcoverage">
          <span class="branchcov high">
            [85.14%]
          </span>
          <span>149/175</span>
          <span class="misses">
            26
          </span>
        </div>
      </div>
      <div id="files">
        
        <div class="file">
            <h2 id="index.js"> index.js</h2>
            <div id="stats">
              <div class="linecoverage">
                <span class="linecov medium">
                  [87%]
                </span>
                <span>77/88<span>
                <span class="misses">
                  11
                </span>
              </div>
              <div class="branchcoverage">
                <span class="branchcov medium">
                  [93%]
                </span>
                <span>31/33</span>
                <span class="misses">
                  2
                </span>
              </div>
            </div>
            <table id="source">
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              </thead>
              <tbody>
                
                
                
                  
                  
                      <tr>
                        <td class="line">1</td>
                        <td class="hits"></td>
                        <td class="source">/*!</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">2</td>
                        <td class="hits"></td>
                        <td class="source"> * cube: index.js</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">3</td>
                        <td class="hits"></td>
                        <td class="source"> * Authors  : fish (https://github.com/fishbar)</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">4</td>
                        <td class="hits"></td>
                        <td class="source"> * Create   : 2014-04-18 15:32:20</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">5</td>
                        <td class="hits"></td>
                        <td class="source"> * CopyRight 2014 (c) Fish And Other Contributors</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">6</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">7</td>
                        <td class="hits">1</td>
                        <td class="source">var utils = require('./lib/utils');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">8</td>
                        <td class="hits">1</td>
                        <td class="source">var path = require('path');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">9</td>
                        <td class="hits">1</td>
                        <td class="source">var JsProcessor = require('./lib/processor_js');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">10</td>
                        <td class="hits">1</td>
                        <td class="source">var debug;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">11</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">12</td>
                        <td class="hits"></td>
                        <td class="source">try {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">13</td>
                        <td class="hits">1</td>
                        <td class="source">  debug = require('./debug.json');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">14</td>
                        <td class="hits"></td>
                        <td class="source">} catch (e) {}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">15</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">16</td>
                        <td class="hits"></td>
                        <td class="source">function debugRegister(cube, module) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">17</td>
                        <td class="hits"></td>
                        <td class="source">  if (!debug) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">18</td>
                        <td class="hits">0</td>
                        <td class="source">    return;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">19</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">20</td>
                        <td class="hits">4</td>
                        <td class="source">  console.error('load debug processor', module);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">21</td>
                        <td class="hits"></td>
                        <td class="source">  try {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">22</td>
                        <td class="hits">4</td>
                        <td class="source">    cube.register(module);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">23</td>
                        <td class="hits"></td>
                        <td class="source">  } catch (e) {}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">24</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">25</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">26</td>
                        <td class="hits"></td>
                        <td class="source">function defaultProcessor(cube) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">27</td>
                        <td class="hits">1</td>
                        <td class="source">  cube.register(path.join(__dirname, './lib/processor_js'));</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">28</td>
                        <td class="hits">1</td>
                        <td class="source">  cube.register(path.join(__dirname, './lib/processor_coffee'));</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">29</td>
                        <td class="hits">1</td>
                        <td class="source">  cube.register(path.join(__dirname, './lib/processor_css'));</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">30</td>
                        <td class="hits">1</td>
                        <td class="source">  cube.register(path.join(__dirname, './lib/processor_html'));</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">31</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">32</td>
                        <td class="hits">1</td>
                        <td class="source">  debugRegister(cube, 'cube-ejs');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">33</td>
                        <td class="hits">1</td>
                        <td class="source">  debugRegister(cube, 'cube-jade');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">34</td>
                        <td class="hits">1</td>
                        <td class="source">  debugRegister(cube, 'cube-less');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">35</td>
                        <td class="hits">1</td>
                        <td class="source">  debugRegister(cube, 'cube-stylus');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">36</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">37</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">38</td>
                        <td class="hits"></td>
                        <td class="source">/**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">39</td>
                        <td class="hits"></td>
                        <td class="source"> * [Cube description]</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">40</td>
                        <td class="hits"></td>
                        <td class="source"> * @param {Object} config</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">41</td>
                        <td class="hits"></td>
                        <td class="source"> *        - root {Path}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">42</td>
                        <td class="hits"></td>
                        <td class="source"> *        - port {String} [optional] server port</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">43</td>
                        <td class="hits"></td>
                        <td class="source"> *        - router {String} [optional] server router match</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">44</td>
                        <td class="hits"></td>
                        <td class="source"> *        - release {Boolean} if build project, set true</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">45</td>
                        <td class="hits"></td>
                        <td class="source"> *        - processors {Array} [optional] set the extenal processors</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">46</td>
                        <td class="hits"></td>
                        <td class="source"> *        - resBase {String} [optional] the http base for resource</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">47</td>
                        <td class="hits"></td>
                        <td class="source"> *        - scope {String} [optional] set the module scope, like '@ali' [X]</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">48</td>
                        <td class="hits"></td>
                        <td class="source"> *        - devCache {Boolean} default true</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">49</td>
                        <td class="hits"></td>
                        <td class="source"> *</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">50</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">51</td>
                        <td class="hits"></td>
                        <td class="source">function Cube(config) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">52</td>
                        <td class="hits"></td>
                        <td class="source">  // remove the last slash(\|/) in config.root</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">53</td>
                        <td class="hits">1</td>
                        <td class="source">  config.root = config.root.replace(/[\\\/]$/, '');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">54</td>
                        <td class="hits"></td>
                        <td class="source">  if (config.devCache === undefined) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">55</td>
                        <td class="hits">1</td>
                        <td class="source">    config.devCache = true;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">56</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">57</td>
                        <td class="hits">1</td>
                        <td class="source">  this.config = config;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">58</td>
                        <td class="hits"></td>
                        <td class="source">  /**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">59</td>
                        <td class="hits"></td>
                        <td class="source">   * processor mapping</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">60</td>
                        <td class="hits"></td>
                        <td class="source">   * @type {Object}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">61</td>
                        <td class="hits"></td>
                        <td class="source">   *       {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">62</td>
                        <td class="hits"></td>
                        <td class="source">   *         // from ext to type</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">63</td>
                        <td class="hits"></td>
                        <td class="source">   *         map: {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">64</td>
                        <td class="hits"></td>
                        <td class="source">   *           '.js': 'script'</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">65</td>
                        <td class="hits"></td>
                        <td class="source">   *         },</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">66</td>
                        <td class="hits"></td>
                        <td class="source">   *         types: {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">67</td>
                        <td class="hits"></td>
                        <td class="source">   *           script: {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">68</td>
                        <td class="hits"></td>
                        <td class="source">   *             '.js': 'js_processor',</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">69</td>
                        <td class="hits"></td>
                        <td class="source">   *             '.coffee': 'js_processor'</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">70</td>
                        <td class="hits"></td>
                        <td class="source">   *           },</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">71</td>
                        <td class="hits"></td>
                        <td class="source">   *           style: {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">72</td>
                        <td class="hits"></td>
                        <td class="source">   *             '.css': 'css_processor',</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">73</td>
                        <td class="hits"></td>
                        <td class="source">   *             '.less': 'less_processor'</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">74</td>
                        <td class="hits"></td>
                        <td class="source">   *           },</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">75</td>
                        <td class="hits"></td>
                        <td class="source">   *           template: {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">76</td>
                        <td class="hits"></td>
                        <td class="source">   *             '.jade': 'tpl_processor',</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">77</td>
                        <td class="hits"></td>
                        <td class="source">   *             '.ejs': 'tpl_processor'</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">78</td>
                        <td class="hits"></td>
                        <td class="source">   *           }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">79</td>
                        <td class="hits"></td>
                        <td class="source">   *         }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">80</td>
                        <td class="hits"></td>
                        <td class="source">   *       }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">81</td>
                        <td class="hits"></td>
                        <td class="source">   */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">82</td>
                        <td class="hits"></td>
                        <td class="source">  if (this.config.compress === undefined) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">83</td>
                        <td class="hits">1</td>
                        <td class="source">    this.config.compress;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">84</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">85</td>
                        <td class="hits">1</td>
                        <td class="source">  this.processors = {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">86</td>
                        <td class="hits"></td>
                        <td class="source">    map: {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">87</td>
                        <td class="hits"></td>
                        <td class="source">      '.js': 'script',</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">88</td>
                        <td class="hits"></td>
                        <td class="source">      '.css': 'style'</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">89</td>
                        <td class="hits"></td>
                        <td class="source">    },</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">90</td>
                        <td class="hits"></td>
                        <td class="source">    types: {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">91</td>
                        <td class="hits"></td>
                        <td class="source">      script: {},</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">92</td>
                        <td class="hits"></td>
                        <td class="source">      style: {}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">93</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">94</td>
                        <td class="hits"></td>
                        <td class="source">  };</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">95</td>
                        <td class="hits">1</td>
                        <td class="source">  this.mimeType = {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">96</td>
                        <td class="hits"></td>
                        <td class="source">    'script': 'application/javascript',</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">97</td>
                        <td class="hits"></td>
                        <td class="source">    'style': 'text/css',</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">98</td>
                        <td class="hits"></td>
                        <td class="source">    'template': 'text/html'</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">99</td>
                        <td class="hits"></td>
                        <td class="source">  };</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">100</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">101</td>
                        <td class="hits">1</td>
                        <td class="source">  defaultProcessor(this);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">102</td>
                        <td class="hits">1</td>
                        <td class="source">  var self = this;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">103</td>
                        <td class="hits"></td>
                        <td class="source">  if (config.processors) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">104</td>
                        <td class="hits">1</td>
                        <td class="source">    config.processors.forEach(function (processor) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">105</td>
                        <td class="hits"></td>
                        <td class="source">      if (!processor) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">106</td>
                        <td class="hits">0</td>
                        <td class="source">        return ;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">107</td>
                        <td class="hits"></td>
                        <td class="source">      }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">108</td>
                        <td class="hits">4</td>
                        <td class="source">      self.register(processor, true);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">109</td>
                        <td class="hits"></td>
                        <td class="source">    });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">110</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">111</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">112</td>
                        <td class="hits"></td>
                        <td class="source">/**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">113</td>
                        <td class="hits"></td>
                        <td class="source"> *</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">114</td>
                        <td class="hits"></td>
                        <td class="source"> * @param  {Object} config</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">115</td>
                        <td class="hits"></td>
                        <td class="source"> *         - port       listen port [optional]</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">116</td>
                        <td class="hits"></td>
                        <td class="source"> *         - connect    the connect object</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">117</td>
                        <td class="hits"></td>
                        <td class="source"> *         - root       static root</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">118</td>
                        <td class="hits"></td>
                        <td class="source"> *         - router     http path</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">119</td>
                        <td class="hits"></td>
                        <td class="source"> *         - middleware  boolean, default false</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">120</td>
                        <td class="hits"></td>
                        <td class="source"> *         - processors {Array} extenal processors</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">121</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">122</td>
                        <td class="hits">1</td>
                        <td class="source">Cube.init = function (config) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">123</td>
                        <td class="hits">1</td>
                        <td class="source">  var cube = new Cube(config);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">124</td>
                        <td class="hits">1</td>
                        <td class="source">  var service = require('./service');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">125</td>
                        <td class="hits">1</td>
                        <td class="source">  service.init(cube, config);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">126</td>
                        <td class="hits"></td>
                        <td class="source">  if (config.middleware) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">127</td>
                        <td class="hits">0</td>
                        <td class="source">    return cube.middleware;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">128</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">129</td>
                        <td class="hits">1</td>
                        <td class="source">  return cube;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">130</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">131</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">132</td>
                        <td class="hits">1</td>
                        <td class="source">Cube.getTool = function () {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">133</td>
                        <td class="hits">0</td>
                        <td class="source">  return require('./tools');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">134</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">135</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">136</td>
                        <td class="hits">1</td>
                        <td class="source">Cube.prototype.getType = function (fpath) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">137</td>
                        <td class="hits">12</td>
                        <td class="source">  var ext = fpath.match(/\.\w+$/);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">138</td>
                        <td class="hits"></td>
                        <td class="source">  if (!ext) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">139</td>
                        <td class="hits">1</td>
                        <td class="source">    return null;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">140</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">141</td>
                        <td class="hits">11</td>
                        <td class="source">  ext = ext[0];</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">142</td>
                        <td class="hits">11</td>
                        <td class="source">  return this.processors.map[ext];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">143</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">144</td>
                        <td class="hits"></td>
                        <td class="source">/**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">145</td>
                        <td class="hits"></td>
                        <td class="source"> * register a processor for cube</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">146</td>
                        <td class="hits"></td>
                        <td class="source"> * @param  {String|Object} mod   mod can be a string(module path) or an mod object</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">147</td>
                        <td class="hits"></td>
                        <td class="source"> *     a module shoud contain {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">148</td>
                        <td class="hits"></td>
                        <td class="source"> *       ext: {String|Array}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">149</td>
                        <td class="hits"></td>
                        <td class="source"> *       type: {String}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">150</td>
                        <td class="hits"></td>
                        <td class="source"> *       process: {Function}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">151</td>
                        <td class="hits"></td>
                        <td class="source"> *     }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">152</td>
                        <td class="hits"></td>
                        <td class="source"> * @param  {Boolean} force       set force will override the origin register</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">153</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">154</td>
                        <td class="hits">1</td>
                        <td class="source">Cube.prototype.register = function (mod, force) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">155</td>
                        <td class="hits">12</td>
                        <td class="source">  var processors = this.processors;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">156</td>
                        <td class="hits">12</td>
                        <td class="source">  var info, type, ext;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">157</td>
                        <td class="hits">12</td>
                        <td class="source">  var Processor;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">158</td>
                        <td class="hits"></td>
                        <td class="source">  try {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">159</td>
                        <td class="hits"></td>
                        <td class="source">    if (typeof mod === 'string') {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">160</td>
                        <td class="hits">11</td>
                        <td class="source">      Processor = require(mod);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">161</td>
                        <td class="hits"></td>
                        <td class="source">    } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">162</td>
                        <td class="hits">1</td>
                        <td class="source">      Processor = mod;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">163</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">164</td>
                        <td class="hits"></td>
                        <td class="source">  } catch (e) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">165</td>
                        <td class="hits">0</td>
                        <td class="source">    console.error('[CUBE_ERRROR]load processor error', mod, e);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">166</td>
                        <td class="hits">0</td>
                        <td class="source">    return;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">167</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">168</td>
                        <td class="hits"></td>
                        <td class="source">  if (Processor.info) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">169</td>
                        <td class="hits">8</td>
                        <td class="source">    type = Processor.info.type;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">170</td>
                        <td class="hits">8</td>
                        <td class="source">    ext = Processor.info.ext;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">171</td>
                        <td class="hits"></td>
                        <td class="source">  } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">172</td>
                        <td class="hits">4</td>
                        <td class="source">    type = Processor.type;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">173</td>
                        <td class="hits">4</td>
                        <td class="source">    ext = Processor.ext;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">174</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">175</td>
                        <td class="hits"></td>
                        <td class="source">  if (!type || !ext || !Processor.prototype.process) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">176</td>
                        <td class="hits">0</td>
                        <td class="source">    return console.error('[CUBE_ERRROR] processor error, en processor should contain properties `name`, `type`, `ext`, `process`');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">177</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">178</td>
                        <td class="hits">12</td>
                        <td class="source">  var types = processors.types[type];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">179</td>
                        <td class="hits"></td>
                        <td class="source">  if (!types) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">180</td>
                        <td class="hits"></td>
                        <td class="source">    // register new type</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">181</td>
                        <td class="hits">1</td>
                        <td class="source">    types = processors.types[type] = {};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">182</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">183</td>
                        <td class="hits"></td>
                        <td class="source">  if (!Array.isArray(ext)) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">184</td>
                        <td class="hits">12</td>
                        <td class="source">    ext = [ext];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">185</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">186</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">187</td>
                        <td class="hits">12</td>
                        <td class="source">  var self = this;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">188</td>
                        <td class="hits">12</td>
                        <td class="source">  ext.forEach(function (extName) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">189</td>
                        <td class="hits"></td>
                        <td class="source">    if (!processors.map[extName]) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">190</td>
                        <td class="hits">6</td>
                        <td class="source">      processors.map[extName] = type;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">191</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">192</td>
                        <td class="hits">12</td>
                        <td class="source">    var origin = types[extName];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">193</td>
                        <td class="hits"></td>
                        <td class="source">    if (origin && !force) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">194</td>
                        <td class="hits">0</td>
                        <td class="source">      var err = new Error('the ext `' + extName + '` is already binded, you should pass `force` param to override it!');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">195</td>
                        <td class="hits">0</td>
                        <td class="source">      err.code = 'CUBE_BIND_TRANSFER_ERROR';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">196</td>
                        <td class="hits">0</td>
                        <td class="source">      throw err;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">197</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">198</td>
                        <td class="hits">12</td>
                        <td class="source">    types[extName] = new Processor(self);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">199</td>
                        <td class="hits"></td>
                        <td class="source">  });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">200</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">201</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">202</td>
                        <td class="hits">1</td>
                        <td class="source">Cube.prototype.getMIMEType = function (type) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">203</td>
                        <td class="hits">49</td>
                        <td class="source">  var defaultMime = 'text/plain';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">204</td>
                        <td class="hits">49</td>
                        <td class="source">  return this.mimeType[type] || <i class="cond-miss">defaultMime</i>;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">205</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">206</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">207</td>
                        <td class="hits">1</td>
                        <td class="source">Cube.prototype.wrapScript = function (qpath, code, require) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">208</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">209</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">210</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">211</td>
                        <td class="hits">1</td>
                        <td class="source">Cube.prototype.wrapStyle = function (qpath, code) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">212</td>
                        <td class="hits">4</td>
                        <td class="source">  var options = this.config;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">213</td>
                        <td class="hits">4</td>
                        <td class="source">  return 'Cube("' + utils.moduleName(qpath, 'style', options.release) + '", [], function(m){m.exports=' + JSON.stringify(code) + ';return m.exports});';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">214</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">215</td>
                        <td class="hits"></td>
                        <td class="source">/** 修订css文件中的资源文件中的路径 **/</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">216</td>
                        <td class="hits">1</td>
                        <td class="source">Cube.prototype.fixupResPath = function (dir, code) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">217</td>
                        <td class="hits">13</td>
                        <td class="source">  var base = this.config.resBase || '';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">218</td>
                        <td class="hits">13</td>
                        <td class="source">  return code.replace(/url\( *([\'\"]*)([^\'\"\)]+)\1 *\)/ig, function (m0, m1, m2) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">219</td>
                        <td class="hits"></td>
                        <td class="source">    if (!m2) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">220</td>
                        <td class="hits">0</td>
                        <td class="source">      return m0; // url() content is empty, do nothing</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">221</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">222</td>
                        <td class="hits">17</td>
                        <td class="source">    m2 = m2.trim();</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">223</td>
                        <td class="hits"></td>
                        <td class="source">    if (m2.indexOf('data:') === 0) { // url() is a base64 coded resource, ignore</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">224</td>
                        <td class="hits">2</td>
                        <td class="source">      return m0;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">225</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">226</td>
                        <td class="hits"></td>
                        <td class="source">    if (m2.indexOf('/') === 0 || /https?:\/\//.test(m2)) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">227</td>
                        <td class="hits">6</td>
                        <td class="source">      return m0.replace(/\"|\'/g, ''); // url() is pointer to a abs path resource</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">228</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">229</td>
                        <td class="hits">9</td>
                        <td class="source">    return 'url(' + path.join(base, dir, m2) + ')';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">230</td>
                        <td class="hits"></td>
                        <td class="source">  });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">231</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">232</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">233</td>
                        <td class="hits">1</td>
                        <td class="source">Cube.prototype.wrapTemplate = function (qpath, code, require, literal) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">234</td>
                        <td class="hits">3</td>
                        <td class="source">  var options = this.config;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">235</td>
                        <td class="hits">3</td>
                        <td class="source">  require = require ? require : <i class="cond-miss">[]</i>;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">236</td>
                        <td class="hits">3</td>
                        <td class="source">  literal = literal === 'string' ? true : false;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">237</td>
                        <td class="hits"></td>
                        <td class="source">  if (literal) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">238</td>
                        <td class="hits">1</td>
                        <td class="source">    code = 'module.exports=function(){return ' + JSON.stringify(code) + '};';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">239</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">240</td>
                        <td class="hits">3</td>
                        <td class="source">  return 'Cube("' + utils.moduleName(qpath, 'template', options.release) +</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">241</td>
                        <td class="hits"></td>
                        <td class="source">    '",' + JSON.stringify(require) + ',function(module,exports,require){' + code + '; return module.exports});';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">242</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">243</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">244</td>
                        <td class="hits">1</td>
                        <td class="source">Cube.prototype.processJsCode = function (filepath, code, options, callback) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">245</td>
                        <td class="hits">7</td>
                        <td class="source">  return JsProcessor.prototype.processCode.call(this, filepath, code, options, callback);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">246</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">247</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">248</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">249</td>
                        <td class="hits">1</td>
                        <td class="source">module.exports = Cube;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">250</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">251</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
        <div class="file">
            <h2 id="lib/processor_coffee.js"> lib/processor_coffee.js</h2>
            <div id="stats">
              <div class="linecoverage">
                <span class="linecov low">
                  [76%]
                </span>
                <span>13/17<span>
                <span class="misses">
                  4
                </span>
              </div>
              <div class="branchcoverage">
                <span class="branchcov low">
                  [100%]
                </span>
                <span>2/2</span>
                <span class="misses">
                  0
                </span>
              </div>
            </div>
            <table id="source">
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              </thead>
              <tbody>
                
                
                
                  
                  
                      <tr class="hit">
                        <td class="line">1</td>
                        <td class="hits">1</td>
                        <td class="source">var path = require('path');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">2</td>
                        <td class="hits">1</td>
                        <td class="source">var fs = require('fs');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">3</td>
                        <td class="hits">1</td>
                        <td class="source">var coffee = require('coffee-script');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">4</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">5</td>
                        <td class="hits"></td>
                        <td class="source">/**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">6</td>
                        <td class="hits"></td>
                        <td class="source"> * Class JsProcessor</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">7</td>
                        <td class="hits"></td>
                        <td class="source"> * @param {Object}   cube     the cube instance</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">8</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">9</td>
                        <td class="hits"></td>
                        <td class="source">function CoffeeProcessor(cube) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">10</td>
                        <td class="hits">1</td>
                        <td class="source">  this.cube = cube;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">11</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">12</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">13</td>
                        <td class="hits">1</td>
                        <td class="source">CoffeeProcessor.type = 'script';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">14</td>
                        <td class="hits">1</td>
                        <td class="source">CoffeeProcessor.ext = '.coffee';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">15</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">16</td>
                        <td class="hits">1</td>
                        <td class="source">CoffeeProcessor.prototype = {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">17</td>
                        <td class="hits"></td>
                        <td class="source">  /**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">18</td>
                        <td class="hits"></td>
                        <td class="source">   * process js file</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">19</td>
                        <td class="hits"></td>
                        <td class="source">   * @param {Path}     file     the module file relative path, based on cube base</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">20</td>
                        <td class="hits"></td>
                        <td class="source">   * @param {Object}   options  {root: path, compress:boolean, sourceMap:boolean, moduleWrap}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">21</td>
                        <td class="hits"></td>
                        <td class="source">   * @param {Function} callback({err, data:{source, code, sourceMap}})</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">22</td>
                        <td class="hits"></td>
                        <td class="source">   */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">23</td>
                        <td class="hits"></td>
                        <td class="source">  process: function (file, options, callback) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">24</td>
                        <td class="hits">7</td>
                        <td class="source">    var code;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">25</td>
                        <td class="hits">7</td>
                        <td class="source">    var root = options.root;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">26</td>
                        <td class="hits"></td>
                        <td class="source">    try {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">27</td>
                        <td class="hits">7</td>
                        <td class="source">      code = fs.readFileSync(path.join(root, file), 'utf8');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">28</td>
                        <td class="hits"></td>
                        <td class="source">    } catch (e) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">29</td>
                        <td class="hits"></td>
                        <td class="source">      // e.message = 'file not found "' + filepath + '"';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">30</td>
                        <td class="hits"></td>
                        <td class="source">      // e.name = 'FILE_NOT_FOUND';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">31</td>
                        <td class="hits">0</td>
                        <td class="source">      return callback(e);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">32</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">33</td>
                        <td class="hits"></td>
                        <td class="source">    // return origin code if no need to transfer</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">34</td>
                        <td class="hits"></td>
                        <td class="source">    if (!options.moduleWrap) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">35</td>
                        <td class="hits">0</td>
                        <td class="source">      return callback(null, {source: code, code: code});</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">36</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">37</td>
                        <td class="hits">7</td>
                        <td class="source">    code = coffee.compile(code, {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">38</td>
                        <td class="hits"></td>
                        <td class="source">      generatedFile: path.basename(file),</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">39</td>
                        <td class="hits"></td>
                        <td class="source">      header: true,</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">40</td>
                        <td class="hits"></td>
                        <td class="source">      shiftLine: true,</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">41</td>
                        <td class="hits"></td>
                        <td class="source">      sourceRoot: '',</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">42</td>
                        <td class="hits"></td>
                        <td class="source">      sourceFiles: [path.basename(file) + '?m'],</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">43</td>
                        <td class="hits"></td>
                        <td class="source">      sourceMap: options.sourceMap</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">44</td>
                        <td class="hits"></td>
                        <td class="source">    });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">45</td>
                        <td class="hits"></td>
                        <td class="source">    if (options.release) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">46</td>
                        <td class="hits">0</td>
                        <td class="source">      file = file.replace(/\.coffee/g, '.js');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">47</td>
                        <td class="hits">0</td>
                        <td class="source">      options.qpath = file;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">48</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">49</td>
                        <td class="hits">7</td>
                        <td class="source">    this.cube.processJsCode.call(this, file, code, options, callback);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">50</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">51</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">52</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">53</td>
                        <td class="hits">1</td>
                        <td class="source">module.exports = CoffeeProcessor;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">54</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
        <div class="file">
            <h2 id="lib/processor_css.js"> lib/processor_css.js</h2>
            <div id="stats">
              <div class="linecoverage">
                <span class="linecov medium">
                  [88%]
                </span>
                <span>16/18<span>
                <span class="misses">
                  2
                </span>
              </div>
              <div class="branchcoverage">
                <span class="branchcov medium">
                  [100%]
                </span>
                <span>2/2</span>
                <span class="misses">
                  0
                </span>
              </div>
            </div>
            <table id="source">
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              </thead>
              <tbody>
                
                
                
                  
                  
                      <tr class="hit">
                        <td class="line">1</td>
                        <td class="hits">1</td>
                        <td class="source">var fs = require('fs');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">2</td>
                        <td class="hits">1</td>
                        <td class="source">var path = require('path');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">3</td>
                        <td class="hits">1</td>
                        <td class="source">var Css = require('clean-css');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">4</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">5</td>
                        <td class="hits"></td>
                        <td class="source">function CssProcessor(cube) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">6</td>
                        <td class="hits">1</td>
                        <td class="source">  this.cube = cube;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">7</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">8</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">9</td>
                        <td class="hits">1</td>
                        <td class="source">CssProcessor.type = 'style';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">10</td>
                        <td class="hits">1</td>
                        <td class="source">CssProcessor.ext = '.css';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">11</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">12</td>
                        <td class="hits">1</td>
                        <td class="source">CssProcessor.prototype = {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">13</td>
                        <td class="hits"></td>
                        <td class="source">  process: function (file, options, callback) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">14</td>
                        <td class="hits">4</td>
                        <td class="source">    var root = options.root;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">15</td>
                        <td class="hits">4</td>
                        <td class="source">    var code;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">16</td>
                        <td class="hits">4</td>
                        <td class="source">    code = fs.readFileSync(path.join(root, file)).toString();</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">17</td>
                        <td class="hits">4</td>
                        <td class="source">    var result = {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">18</td>
                        <td class="hits"></td>
                        <td class="source">      source: code,</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">19</td>
                        <td class="hits"></td>
                        <td class="source">      code: code</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">20</td>
                        <td class="hits"></td>
                        <td class="source">    };</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">21</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">22</td>
                        <td class="hits"></td>
                        <td class="source">    if (options.compress) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">23</td>
                        <td class="hits"></td>
                        <td class="source">      try {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">24</td>
                        <td class="hits">3</td>
                        <td class="source">        result.code = new Css({</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">25</td>
                        <td class="hits"></td>
                        <td class="source">          compatibility: true,</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">26</td>
                        <td class="hits"></td>
                        <td class="source">          noAdvanced: true,</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">27</td>
                        <td class="hits"></td>
                        <td class="source">          keepSpecialComments: 0</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">28</td>
                        <td class="hits"></td>
                        <td class="source">        }).minify(code);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">29</td>
                        <td class="hits"></td>
                        <td class="source">      } catch (e) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">30</td>
                        <td class="hits">0</td>
                        <td class="source">        e.message = '[CUBE] processor-css minify css error' + e.message + ' ' + file;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">31</td>
                        <td class="hits">0</td>
                        <td class="source">        return callback(e);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">32</td>
                        <td class="hits"></td>
                        <td class="source">      }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">33</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">34</td>
                        <td class="hits">4</td>
                        <td class="source">    result.code = this.cube.fixupResPath(path.dirname(options.qpath), result.code);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">35</td>
                        <td class="hits"></td>
                        <td class="source">    if (options.moduleWrap) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">36</td>
                        <td class="hits">1</td>
                        <td class="source">      result.wraped = this.cube.wrapStyle(options.qpath, result.code);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">37</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">38</td>
                        <td class="hits">4</td>
                        <td class="source">    callback(null, result);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">39</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">40</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">41</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">42</td>
                        <td class="hits">1</td>
                        <td class="source">module.exports = CssProcessor;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">43</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
        <div class="file">
            <h2 id="lib/processor_html.js"> lib/processor_html.js</h2>
            <div id="stats">
              <div class="linecoverage">
                <span class="linecov high">
                  [93%]
                </span>
                <span>14/15<span>
                <span class="misses">
                  1
                </span>
              </div>
              <div class="branchcoverage">
                <span class="branchcov high">
                  [100%]
                </span>
                <span>1/1</span>
                <span class="misses">
                  0
                </span>
              </div>
            </div>
            <table id="source">
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              </thead>
              <tbody>
                
                
                
                  
                  
                      <tr>
                        <td class="line">1</td>
                        <td class="hits"></td>
                        <td class="source">/*!</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">2</td>
                        <td class="hits"></td>
                        <td class="source"> * cube: lib/csscombine.js</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">3</td>
                        <td class="hits"></td>
                        <td class="source"> * Authors  : Fish (https://github.com/fishbar)</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">4</td>
                        <td class="hits"></td>
                        <td class="source"> * Create   : 2014-04-18 15:32:20</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">5</td>
                        <td class="hits"></td>
                        <td class="source"> * CopyRight 2014 (c) Fish And Other Contributors</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">6</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">7</td>
                        <td class="hits">1</td>
                        <td class="source">var path = require('path');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">8</td>
                        <td class="hits">1</td>
                        <td class="source">var fs = require('fs');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">9</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">10</td>
                        <td class="hits"></td>
                        <td class="source">function HtmlProcessor(cube) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">11</td>
                        <td class="hits">1</td>
                        <td class="source">  this.cube = cube;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">12</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">13</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">14</td>
                        <td class="hits">1</td>
                        <td class="source">HtmlProcessor.type = 'template';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">15</td>
                        <td class="hits">1</td>
                        <td class="source">HtmlProcessor.ext = '.html';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">16</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">17</td>
                        <td class="hits">1</td>
                        <td class="source">HtmlProcessor.prototype = {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">18</td>
                        <td class="hits"></td>
                        <td class="source">  process: function (file, options, callback) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">19</td>
                        <td class="hits">2</td>
                        <td class="source">    var root = options.root;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">20</td>
                        <td class="hits">2</td>
                        <td class="source">    var error = null, res, code;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">21</td>
                        <td class="hits"></td>
                        <td class="source">    try {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">22</td>
                        <td class="hits">2</td>
                        <td class="source">      var fpath = path.join(root, file);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">23</td>
                        <td class="hits">2</td>
                        <td class="source">      code = fs.readFileSync(fpath, 'utf8').toString();</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">24</td>
                        <td class="hits"></td>
                        <td class="source">    } catch (e) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">25</td>
                        <td class="hits">0</td>
                        <td class="source">      return callback(e);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">26</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">27</td>
                        <td class="hits">2</td>
                        <td class="source">    res = {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">28</td>
                        <td class="hits"></td>
                        <td class="source">      source: code,</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">29</td>
                        <td class="hits"></td>
                        <td class="source">      code: code</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">30</td>
                        <td class="hits"></td>
                        <td class="source">    };</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">31</td>
                        <td class="hits"></td>
                        <td class="source">    if (options.moduleWrap) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">32</td>
                        <td class="hits">1</td>
                        <td class="source">      res.wraped = this.cube.wrapTemplate(options.qpath, code, [], 'string');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">33</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">34</td>
                        <td class="hits">2</td>
                        <td class="source">    callback(error, res);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">35</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">36</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">37</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">38</td>
                        <td class="hits">1</td>
                        <td class="source">module.exports = HtmlProcessor;</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
        <div class="file">
            <h2 id="lib/processor_js.js"> lib/processor_js.js</h2>
            <div id="stats">
              <div class="linecoverage">
                <span class="linecov low">
                  [78%]
                </span>
                <span>186/237<span>
                <span class="misses">
                  51
                </span>
              </div>
              <div class="branchcoverage">
                <span class="branchcov low">
                  [86%]
                </span>
                <span>63/73</span>
                <span class="misses">
                  10
                </span>
              </div>
            </div>
            <table id="source">
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              </thead>
              <tbody>
                
                
                
                  
                  
                      <tr>
                        <td class="line">1</td>
                        <td class="hits"></td>
                        <td class="source">/*!</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">2</td>
                        <td class="hits"></td>
                        <td class="source"> * cube: lib/js_processor.js</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">3</td>
                        <td class="hits"></td>
                        <td class="source"> * support buth js and coffee</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">4</td>
                        <td class="hits"></td>
                        <td class="source"> * Authors  : fish (https://github.com/fishbar)</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">5</td>
                        <td class="hits"></td>
                        <td class="source"> * Create   : 2014-04-18 15:32:20</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">6</td>
                        <td class="hits"></td>
                        <td class="source"> * CopyRight 2014 (c) Fish And Other Contributors</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">7</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">8</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">9</td>
                        <td class="hits">1</td>
                        <td class="source">'use strict';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">10</td>
                        <td class="hits">1</td>
                        <td class="source">var debug = require('debug')('cube:processor:js');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">11</td>
                        <td class="hits">1</td>
                        <td class="source">var fs = require('fs');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">12</td>
                        <td class="hits">1</td>
                        <td class="source">var ug = require('uglify-js');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">13</td>
                        <td class="hits">1</td>
                        <td class="source">var path = require('path');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">14</td>
                        <td class="hits">1</td>
                        <td class="source">var utils = require('./utils');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">15</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">16</td>
                        <td class="hits"></td>
                        <td class="source">function getFileName(filepath, ext) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">17</td>
                        <td class="hits">13</td>
                        <td class="source">  var filename = path.basename(filepath);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">18</td>
                        <td class="hits"></td>
                        <td class="source">  if (ext) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">19</td>
                        <td class="hits">13</td>
                        <td class="source">    filename = filename.replace(/\.(\w+)$/, ext);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">20</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">21</td>
                        <td class="hits">13</td>
                        <td class="source">  return filename;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">22</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">23</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">24</td>
                        <td class="hits"></td>
                        <td class="source">/** test path  .js .coffee */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">25</td>
                        <td class="hits"></td>
                        <td class="source">function tryFiles(cube, root, modPath) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">26</td>
                        <td class="hits">32</td>
                        <td class="source">  var origExt = path.extname(modPath);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">27</td>
                        <td class="hits">32</td>
                        <td class="source">  var fName = path.basename(modPath, origExt);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">28</td>
                        <td class="hits">32</td>
                        <td class="source">  origExt = origExt || '.js';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">29</td>
                        <td class="hits">32</td>
                        <td class="source">  debug('tryFiles: %s, ext: %s', modPath, origExt);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">30</td>
                        <td class="hits"></td>
                        <td class="source">  if (!cube.processors.map[origExt]) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">31</td>
                        <td class="hits">2</td>
                        <td class="source">    fName = path.basename(modPath);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">32</td>
                        <td class="hits">2</td>
                        <td class="source">    origExt = '.js';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">33</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">34</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">35</td>
                        <td class="hits">32</td>
                        <td class="source">  var dir = path.dirname(modPath);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">36</td>
                        <td class="hits">32</td>
                        <td class="source">  var arr = fs.readdirSync(dir);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">37</td>
                        <td class="hits">20</td>
                        <td class="source">  var type = cube.processors.map[origExt];</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">38</td>
                        <td class="hits">20</td>
                        <td class="source">  var possibleExts = Object.keys(cube.processors.types[type]);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">39</td>
                        <td class="hits">20</td>
                        <td class="source">  var targetExt = utils.traverseFList(arr, fName, possibleExts);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">40</td>
                        <td class="hits"></td>
                        <td class="source">  if (targetExt instanceof Error) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">41</td>
                        <td class="hits">4</td>
                        <td class="source">    targetExt.message = 'required module not found: `' + modPath.substr(root.length) + '`';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">42</td>
                        <td class="hits">4</td>
                        <td class="source">    throw targetExt;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">43</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">44</td>
                        <td class="hits">16</td>
                        <td class="source">  debug('finally ', fName + targetExt);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">45</td>
                        <td class="hits">16</td>
                        <td class="source">  return path.join(dir, fName + targetExt);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">46</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">47</td>
                        <td class="hits"></td>
                        <td class="source">/**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">48</td>
                        <td class="hits"></td>
                        <td class="source"> * testModPath and return the relative real path</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">49</td>
                        <td class="hits"></td>
                        <td class="source"> * @param  {Path} modPath abs root, may be file, may be module dir</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">50</td>
                        <td class="hits"></td>
                        <td class="source"> * @return {Path}  relative path based on root</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">51</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">52</td>
                        <td class="hits"></td>
                        <td class="source">function testModPath(cube, root, modPath) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">53</td>
                        <td class="hits"></td>
                        <td class="source">  try {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">54</td>
                        <td class="hits"></td>
                        <td class="source">    // test if dir</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">55</td>
                        <td class="hits">38</td>
                        <td class="source">    var stat = fs.statSync(modPath);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">56</td>
                        <td class="hits"></td>
                        <td class="source">    if (stat.isDirectory()) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">57</td>
                        <td class="hits"></td>
                        <td class="source">      // get module default enter</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">58</td>
                        <td class="hits"></td>
                        <td class="source">      try {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">59</td>
                        <td class="hits">6</td>
                        <td class="source">        var pkg = require(path.join(modPath, './package.json'));</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">60</td>
                        <td class="hits"></td>
                        <td class="source">        /**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">61</td>
                        <td class="hits"></td>
                        <td class="source">         * search for browserify config in package.json</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">62</td>
                        <td class="hits"></td>
                        <td class="source">         * "browserify": "d3.js"</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">63</td>
                        <td class="hits"></td>
                        <td class="source">         */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">64</td>
                        <td class="hits"></td>
                        <td class="source">        if (pkg.browserify) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">65</td>
                        <td class="hits">0</td>
                        <td class="source">          modPath = path.join(modPath, pkg.browserify);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">66</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">67</td>
                        <td class="hits"></td>
                        <td class="source">        /**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">68</td>
                        <td class="hits"></td>
                        <td class="source">         * search for spm config in package.json</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">69</td>
                        <td class="hits"></td>
                        <td class="source">         * "spm": {"main": "d3.js"}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">70</td>
                        <td class="hits"></td>
                        <td class="source">         */</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">71</td>
                        <td class="hits"></td>
                        <td class="source">        else if (pkg.spm && <i class="cond-miss">pkg.spm.main</i>) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">72</td>
                        <td class="hits">0</td>
                        <td class="source">          modPath = path.join(modPath, pkg.spm.main);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">73</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">74</td>
                        <td class="hits"></td>
                        <td class="source">        /**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">75</td>
                        <td class="hits"></td>
                        <td class="source">         * search for pkg.main</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">76</td>
                        <td class="hits"></td>
                        <td class="source">         */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">77</td>
                        <td class="hits"></td>
                        <td class="source">        else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">78</td>
                        <td class="hits">2</td>
                        <td class="source">          modPath = path.join(modPath, pkg.main);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">79</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">80</td>
                        <td class="hits">2</td>
                        <td class="source">        debug('testModPath:folder, try to loading package.json->main script', modPath);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">81</td>
                        <td class="hits">2</td>
                        <td class="source">        modPath = tryFiles(cube, root, modPath);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">82</td>
                        <td class="hits"></td>
                        <td class="source">      } catch (e) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">83</td>
                        <td class="hits">4</td>
                        <td class="source">        debug('testModPath:folder, package.json->main not found', e);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">84</td>
                        <td class="hits"></td>
                        <td class="source">        // can not find module main enter, use index.js as default</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">85</td>
                        <td class="hits">4</td>
                        <td class="source">        modPath = path.join(modPath, 'index');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">86</td>
                        <td class="hits">4</td>
                        <td class="source">        debug('testModPath:folder, try to loading folder/index script', modPath);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">87</td>
                        <td class="hits">4</td>
                        <td class="source">        modPath = tryFiles(cube, root, modPath);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">88</td>
                        <td class="hits"></td>
                        <td class="source">      }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">89</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">90</td>
                        <td class="hits"></td>
                        <td class="source">  } catch (e) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">91</td>
                        <td class="hits">26</td>
                        <td class="source">    debug('testModPath:folder, folder/index not found');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">92</td>
                        <td class="hits">26</td>
                        <td class="source">    debug('testModPath, try itself: %s', modPath);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">93</td>
                        <td class="hits">26</td>
                        <td class="source">    modPath = tryFiles(cube, root, modPath);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">94</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">95</td>
                        <td class="hits">22</td>
                        <td class="source">  return modPath.substr(root.length);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">96</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">97</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">98</td>
                        <td class="hits"></td>
                        <td class="source">function testModPathArray(cube, root, parr) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">99</td>
                        <td class="hits">2</td>
                        <td class="source">  var matched = [];</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">100</td>
                        <td class="hits">2</td>
                        <td class="source">  parr.forEach(function (modp) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">101</td>
                        <td class="hits"></td>
                        <td class="source">    try {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">102</td>
                        <td class="hits">2</td>
                        <td class="source">      var p = testModPath(cube, root, modp);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">103</td>
                        <td class="hits">0</td>
                        <td class="source">      matched.push(p);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">104</td>
                        <td class="hits"></td>
                        <td class="source">    } catch (e) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">105</td>
                        <td class="hits"></td>
                        <td class="source">      // do nothing</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">106</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">107</td>
                        <td class="hits"></td>
                        <td class="source">  });</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">108</td>
                        <td class="hits">2</td>
                        <td class="source">  return matched;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">109</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">110</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">111</td>
                        <td class="hits"></td>
                        <td class="source">function tryNodeModules(cube, root, dir, module) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">112</td>
                        <td class="hits">24</td>
                        <td class="source">  var nodeModulesPath = path.join(dir, '/node_modules/');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">113</td>
                        <td class="hits">24</td>
                        <td class="source">  var modp;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">114</td>
                        <td class="hits"></td>
                        <td class="source">  // search node_modules, if match return</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">115</td>
                        <td class="hits"></td>
                        <td class="source">  try {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">116</td>
                        <td class="hits">24</td>
                        <td class="source">    modp = testModPath(cube, root, path.join(root, nodeModulesPath, module));</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">117</td>
                        <td class="hits">10</td>
                        <td class="source">    return modp;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">118</td>
                        <td class="hits"></td>
                        <td class="source">  } catch (e) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">119</td>
                        <td class="hits"></td>
                        <td class="source">    // ignore, go on search</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">120</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">121</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">122</td>
                        <td class="hits"></td>
                        <td class="source">  // search node_modules with namespace</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">123</td>
                        <td class="hits">14</td>
                        <td class="source">  var flist = fs.readdirSync(path.join(root, nodeModulesPath));</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">124</td>
                        <td class="hits">2</td>
                        <td class="source">  var parr = [];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">125</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">126</td>
                        <td class="hits">2</td>
                        <td class="source">  flist.forEach(function (v) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">127</td>
                        <td class="hits"></td>
                        <td class="source">    if (v.indexOf('@') === 0) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">128</td>
                        <td class="hits">2</td>
                        <td class="source">      parr.push(path.join(root, nodeModulesPath, v, module));</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">129</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">130</td>
                        <td class="hits"></td>
                        <td class="source">  });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">131</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">132</td>
                        <td class="hits">2</td>
                        <td class="source">  parr = testModPathArray(cube, root, parr);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">133</td>
                        <td class="hits"></td>
                        <td class="source">  if (!parr.length) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">134</td>
                        <td class="hits"></td>
                        <td class="source">    // --throw new Error('required module not found');--</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">135</td>
                        <td class="hits"></td>
                        <td class="source">    // fix #11</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">136</td>
                        <td class="hits"></td>
                        <td class="source">    // ignore `build-in-module not found error`</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">137</td>
                        <td class="hits"></td>
                        <td class="source">    // and just return the literal moduleName</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">138</td>
                        <td class="hits">2</td>
                        <td class="source">    return module;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">139</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">140</td>
                        <td class="hits">0</td>
                        <td class="source">  return parr[0];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">141</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">142</td>
                        <td class="hits"></td>
                        <td class="source">/**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">143</td>
                        <td class="hits"></td>
                        <td class="source"> * 路径转化</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">144</td>
                        <td class="hits"></td>
                        <td class="source"> * @param {Object} cube    cube instance</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">145</td>
                        <td class="hits"></td>
                        <td class="source"> * @param {ath} [varname] [description]</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">146</td>
                        <td class="hits"></td>
                        <td class="source"> * @param  {[type]} base   [description]</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">147</td>
                        <td class="hits"></td>
                        <td class="source"> * @param  {[type]} module [description]</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">148</td>
                        <td class="hits"></td>
                        <td class="source"> * @return {[type]}        [description]</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">149</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">150</td>
                        <td class="hits"></td>
                        <td class="source">function resolvePath(cube, root, base, module, ifRelease) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">151</td>
                        <td class="hits">24</td>
                        <td class="source">  debug('start resolverPath', root, base, module);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">152</td>
                        <td class="hits">24</td>
                        <td class="source">  var dir = path.dirname(base);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">153</td>
                        <td class="hits">24</td>
                        <td class="source">  var origModule = module;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">154</td>
                        <td class="hits">24</td>
                        <td class="source">  var count = 0;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">155</td>
                        <td class="hits">24</td>
                        <td class="source">  var p;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">156</td>
                        <td class="hits"></td>
                        <td class="source">  // require a common module in node_modules, like "jquery", or "jquery/ajax"</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">157</td>
                        <td class="hits"></td>
                        <td class="source">  if (/^@?\w+/.test(module)) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">158</td>
                        <td class="hits">12</td>
                        <td class="source">    debug('module type: node_modules');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">159</td>
                        <td class="hits"></td>
                        <td class="source">    while (dir) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">160</td>
                        <td class="hits">24</td>
                        <td class="source">      count++;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">161</td>
                        <td class="hits"></td>
                        <td class="source">      try {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">162</td>
                        <td class="hits">24</td>
                        <td class="source">        p = tryNodeModules(cube, root, dir, module);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">163</td>
                        <td class="hits">12</td>
                        <td class="source">        debug('find module in node_modules', p);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">164</td>
                        <td class="hits">12</td>
                        <td class="source">        break;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">165</td>
                        <td class="hits"></td>
                        <td class="source">      } catch (e) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">166</td>
                        <td class="hits"></td>
                        <td class="source">        if (dir === '/') {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">167</td>
                        <td class="hits">0</td>
                        <td class="source">          debug('node_module not found:', origModule);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">168</td>
                        <td class="hits">0</td>
                        <td class="source">          e.message = 'required module not found: `' + origModule + '`';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">169</td>
                        <td class="hits">0</td>
                        <td class="source">          throw e;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">170</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">171</td>
                        <td class="hits">12</td>
                        <td class="source">        dir = path.dirname(dir);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">172</td>
                        <td class="hits"></td>
                        <td class="source">      }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">173</td>
                        <td class="hits"></td>
                        <td class="source">      if (count > 30) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">174</td>
                        <td class="hits">0</td>
                        <td class="source">        debug('seek node_modules 30 times, max retry, exit');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">175</td>
                        <td class="hits">0</td>
                        <td class="source">        var err = new Error('resolvePath error, may be cycle required');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">176</td>
                        <td class="hits">0</td>
                        <td class="source">        err.code = 'CubeResolvePathException';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">177</td>
                        <td class="hits">0</td>
                        <td class="source">        throw err;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">178</td>
                        <td class="hits"></td>
                        <td class="source">      }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">179</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">180</td>
                        <td class="hits"></td>
                        <td class="source">  } else if (/^\//.test(module)) { // if abs path: like "/jquery"</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">181</td>
                        <td class="hits">0</td>
                        <td class="source">    debug('module type: abs_module', module);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">182</td>
                        <td class="hits"></td>
                        <td class="source">    //abs path</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">183</td>
                        <td class="hits">0</td>
                        <td class="source">    p = testModPath(cube, root, path.join(root, module));</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">184</td>
                        <td class="hits"></td>
                        <td class="source">  } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">185</td>
                        <td class="hits">12</td>
                        <td class="source">    debug('module type: relative_module', module);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">186</td>
                        <td class="hits">12</td>
                        <td class="source">    p = testModPath(cube, root, path.join(root, dir, module));</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">187</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">188</td>
                        <td class="hits">24</td>
                        <td class="source">  var ext = path.extname(p);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">189</td>
                        <td class="hits">24</td>
                        <td class="source">  var type = cube.processors.map[ext];</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">190</td>
                        <td class="hits">24</td>
                        <td class="source">  return utils.moduleName(p, type, ifRelease);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">191</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">192</td>
                        <td class="hits"></td>
                        <td class="source">/**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">193</td>
                        <td class="hits"></td>
                        <td class="source"> * generate code and sourcemap for</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">194</td>
                        <td class="hits"></td>
                        <td class="source"> * @param  {AST} ast    [description]</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">195</td>
                        <td class="hits"></td>
                        <td class="source"> * @param  {String} wraper [description]</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">196</td>
                        <td class="hits"></td>
                        <td class="source"> * @return {String}        code</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">197</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">198</td>
                        <td class="hits"></td>
                        <td class="source">function genCode(filepath, ast, wraper, compress, sourceMap) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">199</td>
                        <td class="hits"></td>
                        <td class="source">  //merge wraper</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">200</td>
                        <td class="hits">2</td>
                        <td class="source">  wraper = ug.parse(wraper, {filename: getFileName(filepath, '.source.$1')});</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">201</td>
                        <td class="hits">2</td>
                        <td class="source">  var body = wraper.body[0].body.args[2].body;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">202</td>
                        <td class="hits">2</td>
                        <td class="source">  wraper.body[0].body.args[2].body = ast.body;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">203</td>
                        <td class="hits">2</td>
                        <td class="source">  ast.body.push(body[0]);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">204</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">205</td>
                        <td class="hits">2</td>
                        <td class="source">  wraper.figure_out_scope();</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">206</td>
                        <td class="hits"></td>
                        <td class="source">  // compress</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">207</td>
                        <td class="hits"></td>
                        <td class="source">  if (compress) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">208</td>
                        <td class="hits">2</td>
                        <td class="source">    var sq = ug.Compressor({warnings: false});</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">209</td>
                        <td class="hits">2</td>
                        <td class="source">    wraper = wraper.transform(sq);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">210</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">211</td>
                        <td class="hits">2</td>
                        <td class="source">    wraper.compute_char_frequency();</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">212</td>
                        <td class="hits">2</td>
                        <td class="source">    wraper.mangle_names(true);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">213</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">214</td>
                        <td class="hits">2</td>
                        <td class="source">  var outOption = {};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">215</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">216</td>
                        <td class="hits"></td>
                        <td class="source">  if (sourceMap) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">217</td>
                        <td class="hits">0</td>
                        <td class="source">    outOption.sourceMap = ug.SourceMap({</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">218</td>
                        <td class="hits"></td>
                        <td class="source">      file: getFileName(filepath),</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">219</td>
                        <td class="hits"></td>
                        <td class="source">      orig: sourceMap !== true ? <i class="cond-miss">sourceMap</i> : <i class="cond-miss">undefined</i>,</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">220</td>
                        <td class="hits"></td>
                        <td class="source">      root: ''</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">221</td>
                        <td class="hits"></td>
                        <td class="source">    });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">222</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">223</td>
                        <td class="hits">2</td>
                        <td class="source">  var stream = ug.OutputStream(outOption);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">224</td>
                        <td class="hits">2</td>
                        <td class="source">  wraper.print(stream);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">225</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">226</td>
                        <td class="hits">2</td>
                        <td class="source">  var res = [stream.toString() + (sourceMap ? <i class="cond-miss">'//@ sourceMappingURL=' + getFileName(filepath, '.map')</i> : '')];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">227</td>
                        <td class="hits"></td>
                        <td class="source">  if (outOption.source_map) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">228</td>
                        <td class="hits">0</td>
                        <td class="source">    res.push(outOption.sourceMap.toString());</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">229</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">230</td>
                        <td class="hits">2</td>
                        <td class="source">  return res;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">231</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">232</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">233</td>
                        <td class="hits"></td>
                        <td class="source">function genUncompressCode(head, code, foot, release) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">234</td>
                        <td class="hits"></td>
                        <td class="source">  if (release) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">235</td>
                        <td class="hits">0</td>
                        <td class="source">    return head + '\n' + code + '\n' + foot;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">236</td>
                        <td class="hits"></td>
                        <td class="source">  } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">237</td>
                        <td class="hits">8</td>
                        <td class="source">    return head + code + foot;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">238</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">239</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">240</td>
                        <td class="hits"></td>
                        <td class="source">/**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">241</td>
                        <td class="hits"></td>
                        <td class="source"> * update require path for dev model</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">242</td>
                        <td class="hits"></td>
                        <td class="source"> * @param  {String} code        [description]</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">243</td>
                        <td class="hits"></td>
                        <td class="source"> * @param  {Object} requiresMap [description]</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">244</td>
                        <td class="hits"></td>
                        <td class="source"> * @return {String}             [description]</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">245</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">246</td>
                        <td class="hits"></td>
                        <td class="source">function transferRequire(code, requiresMap) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">247</td>
                        <td class="hits">8</td>
                        <td class="source">  var arr = code.split(/\r?\n/);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">248</td>
                        <td class="hits">8</td>
                        <td class="source">  var tmp, line, res, offset;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">249</td>
                        <td class="hits"></td>
                        <td class="source">  for (var i in requiresMap) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">250</td>
                        <td class="hits">13</td>
                        <td class="source">    res = [];</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">251</td>
                        <td class="hits">13</td>
                        <td class="source">    offset = 0;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">252</td>
                        <td class="hits">13</td>
                        <td class="source">    tmp = requiresMap[i];</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">253</td>
                        <td class="hits">13</td>
                        <td class="source">    line = arr[i];</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">254</td>
                        <td class="hits">13</td>
                        <td class="source">    tmp.forEach(function (item) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">255</td>
                        <td class="hits">16</td>
                        <td class="source">      res.push(line.substring(offset, item.col + 1));</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">256</td>
                        <td class="hits">16</td>
                        <td class="source">      res.push(item.name);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">257</td>
                        <td class="hits">16</td>
                        <td class="source">      offset = item.col + item.offset + 1;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">258</td>
                        <td class="hits"></td>
                        <td class="source">    });</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">259</td>
                        <td class="hits">13</td>
                        <td class="source">    res.push(line.substring(offset));</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">260</td>
                        <td class="hits">13</td>
                        <td class="source">    arr[i] = res.join('');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">261</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">262</td>
                        <td class="hits">8</td>
                        <td class="source">  return arr.join('\n');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">263</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">264</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">265</td>
                        <td class="hits"></td>
                        <td class="source">/**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">266</td>
                        <td class="hits"></td>
                        <td class="source"> * get the most left node in binary expression</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">267</td>
                        <td class="hits"></td>
                        <td class="source"> * @param  {AST_Node} node</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">268</td>
                        <td class="hits"></td>
                        <td class="source"> * @return {AST_Node}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">269</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">270</td>
                        <td class="hits"></td>
                        <td class="source">function getTheLeftNode(node) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">271</td>
                        <td class="hits"></td>
                        <td class="source">  while (node.left) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">272</td>
                        <td class="hits">7</td>
                        <td class="source">    node = node.left;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">273</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">274</td>
                        <td class="hits">5</td>
                        <td class="source">  return node;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">275</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">276</td>
                        <td class="hits"></td>
                        <td class="source">function fillMap(node, tarv, map) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">277</td>
                        <td class="hits">7</td>
                        <td class="source">  var v = node.start.value;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">278</td>
                        <td class="hits">7</td>
                        <td class="source">  var col = node.start.col;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">279</td>
                        <td class="hits">7</td>
                        <td class="source">  var line = node.start.line - 1;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">280</td>
                        <td class="hits"></td>
                        <td class="source">  if (!map[line]) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">281</td>
                        <td class="hits">5</td>
                        <td class="source">    map[line] = [{col: col, offset: v.length, name: tarv}];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">282</td>
                        <td class="hits"></td>
                        <td class="source">  } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">283</td>
                        <td class="hits">2</td>
                        <td class="source">    map[line].push({col: col, offset: v.length, name: tarv});</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">284</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">285</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">286</td>
                        <td class="hits"></td>
                        <td class="source">/**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">287</td>
                        <td class="hits"></td>
                        <td class="source"> * fix the left part, from relpath to abspath</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">288</td>
                        <td class="hits"></td>
                        <td class="source"> * @param  {String} str</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">289</td>
                        <td class="hits"></td>
                        <td class="source"> * @return {String}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">290</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">291</td>
                        <td class="hits"></td>
                        <td class="source">function fixLeftPart(cube, root, filepath, node, release, map) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">292</td>
                        <td class="hits">3</td>
                        <td class="source">  var v = node.value;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">293</td>
                        <td class="hits">3</td>
                        <td class="source">  var abspath = path.join(root, filepath);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">294</td>
                        <td class="hits">3</td>
                        <td class="source">  var err, tmp;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">295</td>
                        <td class="hits"></td>
                        <td class="source">  if (v.indexOf('/') === 0) { // abs path</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">296</td>
                        <td class="hits">0</td>
                        <td class="source">    return ;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">297</td>
                        <td class="hits"></td>
                        <td class="source">  } else if (/^\w/.test(v)) { // the node_module</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">298</td>
                        <td class="hits">0</td>
                        <td class="source">    tmp = path.dirname(abspath);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">299</td>
                        <td class="hits"></td>
                        <td class="source">    while (true) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">300</td>
                        <td class="hits">0</td>
                        <td class="source">      tmp = path.join(tmp, 'node_modules');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">301</td>
                        <td class="hits"></td>
                        <td class="source">      if (<i class="cond-miss">fs.existsSync(tmp)</i>) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">302</td>
                        <td class="hits">0</td>
                        <td class="source">        break;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">303</td>
                        <td class="hits"></td>
                        <td class="source">      }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">304</td>
                        <td class="hits">0</td>
                        <td class="source">      tmp = path.dirname(tmp);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">305</td>
                        <td class="hits"></td>
                        <td class="source">      if (<i class="cond-miss">tmp.length <= root.length</i>) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">306</td>
                        <td class="hits">0</td>
                        <td class="source">        err = new Error('node_modules not found when loading dynamic module');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">307</td>
                        <td class="hits">0</td>
                        <td class="source">        err.name = 'CUBE_EXCEPTION';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">308</td>
                        <td class="hits">0</td>
                        <td class="source">        throw err;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">309</td>
                        <td class="hits"></td>
                        <td class="source">      }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">310</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">311</td>
                        <td class="hits">0</td>
                        <td class="source">    tmp = tmp.substr(root.length);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">312</td>
                        <td class="hits">0</td>
                        <td class="source">    node.value = tmp;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">313</td>
                        <td class="hits"></td>
                        <td class="source">  } else if (v.indexOf('.') === 0) { // the relative path</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">314</td>
                        <td class="hits">3</td>
                        <td class="source">    tmp = path.dirname(filepath, v);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">315</td>
                        <td class="hits"></td>
                        <td class="source">    if (/\/$/.test(v) && !/\/$/.test(tmp)) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">316</td>
                        <td class="hits">3</td>
                        <td class="source">      tmp += '/';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">317</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">318</td>
                        <td class="hits">3</td>
                        <td class="source">    node.value = tmp;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">319</td>
                        <td class="hits"></td>
                        <td class="source">  } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">320</td>
                        <td class="hits">0</td>
                        <td class="source">    err = new Error('unknow error when loading dynamic module');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">321</td>
                        <td class="hits">0</td>
                        <td class="source">    err.name = 'CUBE_EXCEPTION';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">322</td>
                        <td class="hits">0</td>
                        <td class="source">    throw err;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">323</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">324</td>
                        <td class="hits">3</td>
                        <td class="source">  fillMap(node, tmp, map);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">325</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">326</td>
                        <td class="hits"></td>
                        <td class="source">/**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">327</td>
                        <td class="hits"></td>
                        <td class="source"> * fix the right part, change the suffix</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">328</td>
                        <td class="hits"></td>
                        <td class="source"> * @return {String}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">329</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">330</td>
                        <td class="hits"></td>
                        <td class="source">function fixRightPart(cube, root, filepath, node, release, map) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">331</td>
                        <td class="hits">4</td>
                        <td class="source">  var sufix = node.value.match(/\.\w+$/);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">332</td>
                        <td class="hits">4</td>
                        <td class="source">  var tmp, type;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">333</td>
                        <td class="hits"></td>
                        <td class="source">  if (!sufix) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">334</td>
                        <td class="hits">1</td>
                        <td class="source">    tmp = node.value + '.js';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">335</td>
                        <td class="hits"></td>
                        <td class="source">  } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">336</td>
                        <td class="hits">3</td>
                        <td class="source">    sufix = sufix[0];</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">337</td>
                        <td class="hits">3</td>
                        <td class="source">    type = cube.processors.map[sufix];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">338</td>
                        <td class="hits"></td>
                        <td class="source">    if (!type) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">339</td>
                        <td class="hits">0</td>
                        <td class="source">      tmp = node.value + '.js';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">340</td>
                        <td class="hits"></td>
                        <td class="source">    } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">341</td>
                        <td class="hits">3</td>
                        <td class="source">      tmp = utils.moduleName(node.value, type, release);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">342</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">343</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">344</td>
                        <td class="hits">4</td>
                        <td class="source">  node.value = tmp;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">345</td>
                        <td class="hits">4</td>
                        <td class="source">  fillMap(node, tmp, map);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">346</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">347</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">348</td>
                        <td class="hits"></td>
                        <td class="source">/**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">349</td>
                        <td class="hits"></td>
                        <td class="source"> * Class JsProcessor</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">350</td>
                        <td class="hits"></td>
                        <td class="source"> * @param {Object}   cube     the cube instance</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">351</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">352</td>
                        <td class="hits"></td>
                        <td class="source">function JsProcessor(cube) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">353</td>
                        <td class="hits">1</td>
                        <td class="source">  this.cube = cube;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">354</td>
                        <td class="hits"></td>
                        <td class="source">}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">355</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">356</td>
                        <td class="hits">1</td>
                        <td class="source">JsProcessor.type = 'script';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">357</td>
                        <td class="hits">1</td>
                        <td class="source">JsProcessor.ext = '.js';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">358</td>
                        <td class="hits">1</td>
                        <td class="source">JsProcessor.requires = {};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">359</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">360</td>
                        <td class="hits">1</td>
                        <td class="source">JsProcessor.saveRequire = function (file, require) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">361</td>
                        <td class="hits"></td>
                        <td class="source">  if (!this.requires[file]) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">362</td>
                        <td class="hits">5</td>
                        <td class="source">    this.requires[file] = [];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">363</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">364</td>
                        <td class="hits">12</td>
                        <td class="source">  this.requires[file].push(require);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">365</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">366</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">367</td>
                        <td class="hits">1</td>
                        <td class="source">JsProcessor.prototype = {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">368</td>
                        <td class="hits"></td>
                        <td class="source">  /**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">369</td>
                        <td class="hits"></td>
                        <td class="source">   * process js file</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">370</td>
                        <td class="hits"></td>
                        <td class="source">   * @param {Path}     file     the module file relative path, based on cube base</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">371</td>
                        <td class="hits"></td>
                        <td class="source">   * @param {Object}   options  {root: path, compress:boolean, sourceMap:boolean, moduleWrap}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">372</td>
                        <td class="hits"></td>
                        <td class="source">   * @param  {Function} callback({err, data:{source, code, sourceMap}})</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">373</td>
                        <td class="hits"></td>
                        <td class="source">   */</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">374</td>
                        <td class="hits"></td>
                        <td class="source">  process: function (file, options, callback) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">375</td>
                        <td class="hits">6</td>
                        <td class="source">    var code;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">376</td>
                        <td class="hits">6</td>
                        <td class="source">    var root = options.root;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">377</td>
                        <td class="hits"></td>
                        <td class="source">    try {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">378</td>
                        <td class="hits">6</td>
                        <td class="source">      code = fs.readFileSync(path.join(root, file), 'utf8');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">379</td>
                        <td class="hits"></td>
                        <td class="source">    } catch (e) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">380</td>
                        <td class="hits"></td>
                        <td class="source">      // e.message = 'file not found "' + filepath + '"';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">381</td>
                        <td class="hits"></td>
                        <td class="source">      // e.name = 'FILE_NOT_FOUND';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">382</td>
                        <td class="hits">0</td>
                        <td class="source">      return callback(e);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">383</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">384</td>
                        <td class="hits"></td>
                        <td class="source">    // return origin code if no need to transfer</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">385</td>
                        <td class="hits"></td>
                        <td class="source">    if (!options.moduleWrap) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">386</td>
                        <td class="hits">2</td>
                        <td class="source">      return callback(null, {source: code, code: code});</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">387</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">388</td>
                        <td class="hits">4</td>
                        <td class="source">    this.processCode(file, code, options, callback);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">389</td>
                        <td class="hits"></td>
                        <td class="source">  },</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">390</td>
                        <td class="hits"></td>
                        <td class="source">  processCode: function (filepath, code, options, callback) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">391</td>
                        <td class="hits">11</td>
                        <td class="source">    options = options || <i class="cond-miss">{}</i>;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">392</td>
                        <td class="hits"></td>
                        <td class="source">    if (!filepath) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">393</td>
                        <td class="hits">0</td>
                        <td class="source">      callback(new Error('filepath needed!'));</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">394</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">395</td>
                        <td class="hits"></td>
                        <td class="source">    if (!code) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">396</td>
                        <td class="hits">0</td>
                        <td class="source">      code = '';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">397</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">398</td>
                        <td class="hits">11</td>
                        <td class="source">    var ast;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">399</td>
                        <td class="hits"></td>
                        <td class="source">    try {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">400</td>
                        <td class="hits">11</td>
                        <td class="source">      ast = ug.parse(code, {filename: getFileName(filepath, '.source.$1')});</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">401</td>
                        <td class="hits"></td>
                        <td class="source">    } catch (e) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">402</td>
                        <td class="hits">1</td>
                        <td class="source">      e.code = 'Js_Parser_Error';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">403</td>
                        <td class="hits">1</td>
                        <td class="source">      e.message = e.code + ' ' + e.message + ' line: ' + e.line + ', col: ' + e.col + ', pos: ' + e.pos + ' file:' + filepath;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">404</td>
                        <td class="hits">1</td>
                        <td class="source">      return callback(e);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">405</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">406</td>
                        <td class="hits">10</td>
                        <td class="source">    debug('parse ast ok', filepath);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">407</td>
                        <td class="hits">10</td>
                        <td class="source">    var cube = this.cube;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">408</td>
                        <td class="hits">10</td>
                        <td class="source">    var root = options.root;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">409</td>
                        <td class="hits">10</td>
                        <td class="source">    var requires = [];</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">410</td>
                        <td class="hits">10</td>
                        <td class="source">    var requiresMap = {};</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">411</td>
                        <td class="hits">10</td>
                        <td class="source">    var header = 'Cube("$$filepath$$", $$requires$$, function (module, exports, require, async, __dirname, __filename) {';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">412</td>
                        <td class="hits">10</td>
                        <td class="source">    var footer = '\nreturn module.exports;});';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">413</td>
                        <td class="hits">10</td>
                        <td class="source">    var flagMerge = false;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">414</td>
                        <td class="hits">10</td>
                        <td class="source">    var merges = [];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">415</td>
                        <td class="hits"></td>
                        <td class="source">    //////////////////// walker start //////////////////////</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">416</td>
                        <td class="hits">10</td>
                        <td class="source">    var walker = new ug.TreeWalker(function (node) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">417</td>
                        <td class="hits"></td>
                        <td class="source">      if (node instanceof ug.AST_Toplevel) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">418</td>
                        <td class="hits"></td>
                        <td class="source">        if (node.start && node.start.comments_before) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">419</td>
                        <td class="hits">10</td>
                        <td class="source">          var cms = node.start.comments_before;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">420</td>
                        <td class="hits">10</td>
                        <td class="source">          cms.forEach(function (v) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">421</td>
                        <td class="hits"></td>
                        <td class="source">            if (/@merge/.test(v.value)) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">422</td>
                        <td class="hits">0</td>
                        <td class="source">              flagMerge = true;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">423</td>
                        <td class="hits"></td>
                        <td class="source">            }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">424</td>
                        <td class="hits"></td>
                        <td class="source">          });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">425</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">426</td>
                        <td class="hits"></td>
                        <td class="source">      }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">427</td>
                        <td class="hits"></td>
                        <td class="source">      if (node instanceof ug.AST_Call) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">428</td>
                        <td class="hits"></td>
                        <td class="source">        // filter other property calls</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">429</td>
                        <td class="hits"></td>
                        <td class="source">        if (node.expression.property) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">430</td>
                        <td class="hits">37</td>
                        <td class="source">          return;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">431</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">432</td>
                        <td class="hits"></td>
                        <td class="source">        // filter other calls</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">433</td>
                        <td class="hits"></td>
                        <td class="source">        if (node.expression.name !== 'require' && node.expression.name !== 'async') {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">434</td>
                        <td class="hits">50</td>
                        <td class="source">          return;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">435</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">436</td>
                        <td class="hits"></td>
                        <td class="source">        if (!node.expression.thedef.undeclared) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">437</td>
                        <td class="hits">0</td>
                        <td class="source">          return;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">438</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">439</td>
                        <td class="hits"></td>
                        <td class="source">        // ignore empty require and async require</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">440</td>
                        <td class="hits"></td>
                        <td class="source">        if (!node.args.length) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">441</td>
                        <td class="hits">0</td>
                        <td class="source">          return;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">442</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">443</td>
                        <td class="hits"></td>
                        <td class="source">        // check if Binary express, like `async('./abc' + vars + '.js');`</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">444</td>
                        <td class="hits"></td>
                        <td class="source">        if (node.args[0].TYPE === 'Binary') {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">445</td>
                        <td class="hits"></td>
                        <td class="source">          if (node.expression === 'require') {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">446</td>
                        <td class="hits">0</td>
                        <td class="source">            var err = new Error('require not support variable');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">447</td>
                        <td class="hits">0</td>
                        <td class="source">            err.name = 'CUBE_EXCEPTION';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">448</td>
                        <td class="hits">0</td>
                        <td class="source">            throw err;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">449</td>
                        <td class="hits"></td>
                        <td class="source">          }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">450</td>
                        <td class="hits">5</td>
                        <td class="source">          var args0 = node.args[0];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">451</td>
                        <td class="hits"></td>
                        <td class="source">          // get the right and the</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">452</td>
                        <td class="hits">5</td>
                        <td class="source">          var theRight = args0.right;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">453</td>
                        <td class="hits">5</td>
                        <td class="source">          var theLeft = getTheLeftNode(args0);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">454</td>
                        <td class="hits"></td>
                        <td class="source">          if (theLeft.TYPE === 'String') {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">455</td>
                        <td class="hits"></td>
                        <td class="source">            // 处理left前缀</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">456</td>
                        <td class="hits">3</td>
                        <td class="source">            fixLeftPart(cube, root, filepath, theLeft, options.release, requiresMap);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">457</td>
                        <td class="hits"></td>
                        <td class="source">          }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">458</td>
                        <td class="hits"></td>
                        <td class="source">          if (theRight.TYPE === 'String') {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">459</td>
                        <td class="hits"></td>
                        <td class="source">            // 处理right后缀，</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">460</td>
                        <td class="hits">4</td>
                        <td class="source">            fixRightPart(cube, root, filepath, theRight, options.release, requiresMap);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">461</td>
                        <td class="hits"></td>
                        <td class="source">          }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">462</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">463</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">464</td>
                        <td class="hits">18</td>
                        <td class="source">        var v = node.args[0].value;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">465</td>
                        <td class="hits"></td>
                        <td class="source">        if (!v || typeof v !== 'string') {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">466</td>
                        <td class="hits">6</td>
                        <td class="source">          return;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">467</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">468</td>
                        <td class="hits"></td>
                        <td class="source">        if (!v.trim()) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">469</td>
                        <td class="hits">0</td>
                        <td class="source">          return;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">470</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">471</td>
                        <td class="hits"></td>
                        <td class="source">        // node.args[0].vaule -> module</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">472</td>
                        <td class="hits">12</td>
                        <td class="source">        var abspath;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">473</td>
                        <td class="hits">12</td>
                        <td class="source">        var abspathOrigin;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">474</td>
                        <td class="hits">12</td>
                        <td class="source">        var line = node.args[0].start.line - 1;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">475</td>
                        <td class="hits"></td>
                        <td class="source">        try {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">476</td>
                        <td class="hits">12</td>
                        <td class="source">          abspath = resolvePath(cube, root, filepath, v, options.release);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">477</td>
                        <td class="hits">12</td>
                        <td class="source">          abspathOrigin = resolvePath(cube, root, filepath, v);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">478</td>
                        <td class="hits">12</td>
                        <td class="source">          debug('resolved path:', abspath);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">479</td>
                        <td class="hits"></td>
                        <td class="source">        } catch (err) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">480</td>
                        <td class="hits">0</td>
                        <td class="source">          err.file = filepath;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">481</td>
                        <td class="hits">0</td>
                        <td class="source">          err.line = line;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">482</td>
                        <td class="hits">0</td>
                        <td class="source">          err.message += ' at:' + filepath + ' line: ' + line;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">483</td>
                        <td class="hits">0</td>
                        <td class="source">          throw err;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">484</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">485</td>
                        <td class="hits"></td>
                        <td class="source">        if (node.expression.name === 'require') {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">486</td>
                        <td class="hits">11</td>
                        <td class="source">          requires.push(abspath);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">487</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">488</td>
                        <td class="hits">12</td>
                        <td class="source">        JsProcessor.saveRequire(filepath, abspath);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">489</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">490</td>
                        <td class="hits"></td>
                        <td class="source">        if (!requiresMap[line]) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">491</td>
                        <td class="hits">12</td>
                        <td class="source">          requiresMap[line] = [{col: node.args[0].start.col, offset: v.length, name: abspath}];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">492</td>
                        <td class="hits"></td>
                        <td class="source">        } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">493</td>
                        <td class="hits">0</td>
                        <td class="source">          requiresMap[line].push({col: node.args[0].start.col, offset: v.length, name: abspath});</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">494</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">495</td>
                        <td class="hits">12</td>
                        <td class="source">        node.args[0].value = abspath;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">496</td>
                        <td class="hits"></td>
                        <td class="source">        // auto</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">497</td>
                        <td class="hits"></td>
                        <td class="source">        if (cube.getType(abspathOrigin) === 'style' && node.args.length === 1) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">498</td>
                        <td class="hits">2</td>
                        <td class="source">          node.args[1] = new ug.AST_String({value: ''});</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">499</td>
                        <td class="hits">2</td>
                        <td class="source">          requiresMap[line].push({col: node.args[0].start.col + v.length + 1, offset: 0, name: ',""'});</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">500</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">501</td>
                        <td class="hits"></td>
                        <td class="source">      }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">502</td>
                        <td class="hits"></td>
                        <td class="source">    });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">503</td>
                        <td class="hits"></td>
                        <td class="source">    ///////////////////// walker end //////////////////////</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">504</td>
                        <td class="hits">10</td>
                        <td class="source">    ast.figure_out_scope();</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">505</td>
                        <td class="hits">10</td>
                        <td class="source">    ast.walk(walker);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">506</td>
                        <td class="hits">10</td>
                        <td class="source">    debug('analyse requires ok');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">507</td>
                        <td class="hits"></td>
                        <td class="source">    // do merge</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">508</td>
                        <td class="hits"></td>
                        <td class="source">    if (flagMerge) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">509</td>
                        <td class="hits"></td>
                        <td class="source">      if (<i class="cond-miss">!merges</i>) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">510</td>
                        <td class="hits">0</td>
                        <td class="source">        merges = {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">511</td>
                        <td class="hits"></td>
                        <td class="source">          list: [],</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">512</td>
                        <td class="hits"></td>
                        <td class="source">          map: {}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">513</td>
                        <td class="hits"></td>
                        <td class="source">        };</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">514</td>
                        <td class="hits"></td>
                        <td class="source">      }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">515</td>
                        <td class="hits">0</td>
                        <td class="source">      requires.forEach(function (v) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">516</td>
                        <td class="hits"></td>
                        <td class="source">        if (<i class="cond-miss">merges[v]</i>) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">517</td>
                        <td class="hits">0</td>
                        <td class="source">          return;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">518</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">519</td>
                        <td class="hits"></td>
                        <td class="source">        // native module</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">520</td>
                        <td class="hits"></td>
                        <td class="source">        if (<i class="cond-miss">!/\//.test(v)</i>) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">521</td>
                        <td class="hits">0</td>
                        <td class="source">          return;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">522</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">523</td>
                        <td class="hits">0</td>
                        <td class="source">        merges[v] = true;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">524</td>
                        <td class="hits"></td>
                        <td class="source">      });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">525</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">526</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">527</td>
                        <td class="hits">10</td>
                        <td class="source">    header = header.replace(/\$\$(\w+)\$\$/g, function (m0, m1) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">528</td>
                        <td class="hits"></td>
                        <td class="source">      switch (m1) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">529</td>
                        <td class="hits"></td>
                        <td class="source">        case 'filepath':</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">530</td>
                        <td class="hits">10</td>
                        <td class="source">          var ext = path.extname(filepath);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">531</td>
                        <td class="hits">10</td>
                        <td class="source">          var type = cube.processors.map[ext];</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">532</td>
                        <td class="hits">10</td>
                        <td class="source">          var p = utils.moduleName(filepath, type, options.relese);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">533</td>
                        <td class="hits"></td>
                        <td class="source">          if (!options.relese && options.qpath) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">534</td>
                        <td class="hits">10</td>
                        <td class="source">            p = options.qpath;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">535</td>
                        <td class="hits"></td>
                        <td class="source">          }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">536</td>
                        <td class="hits">10</td>
                        <td class="source">          return p;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">537</td>
                        <td class="hits"></td>
                        <td class="source">        case 'requires':</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">538</td>
                        <td class="hits">10</td>
                        <td class="source">          return JSON.stringify(requires);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">539</td>
                        <td class="hits"></td>
                        <td class="source">        default:</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">540</td>
                        <td class="hits">0</td>
                        <td class="source">          return m1;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">541</td>
                        <td class="hits"></td>
                        <td class="source">      }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">542</td>
                        <td class="hits"></td>
                        <td class="source">    });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">543</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">544</td>
                        <td class="hits">10</td>
                        <td class="source">    var returnObj = {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">545</td>
                        <td class="hits"></td>
                        <td class="source">      source: code,</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">546</td>
                        <td class="hits"></td>
                        <td class="source">      requires: requires</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">547</td>
                        <td class="hits"></td>
                        <td class="source">    };</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">548</td>
                        <td class="hits"></td>
                        <td class="source">    if (options.compress) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">549</td>
                        <td class="hits">2</td>
                        <td class="source">      var compressRes = genCode(filepath, ast, header + footer, true, options.sourceMap);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">550</td>
                        <td class="hits">2</td>
                        <td class="source">      returnObj.code = compressRes[0];</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">551</td>
                        <td class="hits">2</td>
                        <td class="source">      returnObj.sourceMap = compressRes[1];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">552</td>
                        <td class="hits"></td>
                        <td class="source">    } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">553</td>
                        <td class="hits">8</td>
                        <td class="source">      returnObj.code = genUncompressCode(</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">554</td>
                        <td class="hits"></td>
                        <td class="source">        header,</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">555</td>
                        <td class="hits"></td>
                        <td class="source">        transferRequire(code, requiresMap),</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">556</td>
                        <td class="hits"></td>
                        <td class="source">        footer,</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">557</td>
                        <td class="hits"></td>
                        <td class="source">        options.release</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">558</td>
                        <td class="hits"></td>
                        <td class="source">      );</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">559</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">560</td>
                        <td class="hits">10</td>
                        <td class="source">    callback(null, returnObj);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">561</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">562</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">563</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">564</td>
                        <td class="hits">1</td>
                        <td class="source">module.exports = JsProcessor;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">565</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
        <div class="file">
            <h2 id="lib/utils.js"> lib/utils.js</h2>
            <div id="stats">
              <div class="linecoverage">
                <span class="linecov medium">
                  [80%]
                </span>
                <span>38/47<span>
                <span class="misses">
                  9
                </span>
              </div>
              <div class="branchcoverage">
                <span class="branchcov medium">
                  [68%]
                </span>
                <span>11/16</span>
                <span class="misses">
                  5
                </span>
              </div>
            </div>
            <table id="source">
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              </thead>
              <tbody>
                
                
                
                  
                  
                      <tr class="hit">
                        <td class="line">1</td>
                        <td class="hits">1</td>
                        <td class="source">var debug = require('debug')('cube');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">2</td>
                        <td class="hits">1</td>
                        <td class="source">var path = require('path');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">3</td>
                        <td class="hits">1</td>
                        <td class="source">var fs = require('fs');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">4</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">5</td>
                        <td class="hits">1</td>
                        <td class="source">exports.traverseFList = function (arr, fName, possibleExts) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">6</td>
                        <td class="hits">31</td>
                        <td class="source">  var tmp, ext, index;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">7</td>
                        <td class="hits">31</td>
                        <td class="source">  var matchedExts = [];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">8</td>
                        <td class="hits"></td>
                        <td class="source">  for (var i = 0, len = arr.length; i < len; i++) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">9</td>
                        <td class="hits">354</td>
                        <td class="source">    tmp = arr[i];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">10</td>
                        <td class="hits"></td>
                        <td class="source">    if (tmp.indexOf(fName + '.') !== 0) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">11</td>
                        <td class="hits">329</td>
                        <td class="source">      continue;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">12</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">13</td>
                        <td class="hits">25</td>
                        <td class="source">    ext = tmp.substr(fName.length);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">14</td>
                        <td class="hits">25</td>
                        <td class="source">    index = possibleExts.indexOf(ext);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">15</td>
                        <td class="hits"></td>
                        <td class="source">    if (index !== -1) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">16</td>
                        <td class="hits">25</td>
                        <td class="source">      matchedExts.push([ext, index]);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">17</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">18</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">19</td>
                        <td class="hits"></td>
                        <td class="source">  if (!matchedExts.length) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">20</td>
                        <td class="hits">6</td>
                        <td class="source">    var err = new Error();</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">21</td>
                        <td class="hits">6</td>
                        <td class="source">    err.name = err.code = 'FILE_NOT_FOUND';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">22</td>
                        <td class="hits">6</td>
                        <td class="source">    return err;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">23</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">24</td>
                        <td class="hits"></td>
                        <td class="source">  if (matchedExts.length > 1) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">25</td>
                        <td class="hits">0</td>
                        <td class="source">    debug('more then one file with same fileName but different ext', matchedExts);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">26</td>
                        <td class="hits">0</td>
                        <td class="source">    console.log('[WARN] more then one file with same fileName but different ext', matchedExts);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">27</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">28</td>
                        <td class="hits">25</td>
                        <td class="source">  ext = '';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">29</td>
                        <td class="hits">25</td>
                        <td class="source">  index = possibleExts.length;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">30</td>
                        <td class="hits">25</td>
                        <td class="source">  matchedExts.forEach(function (v) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">31</td>
                        <td class="hits"></td>
                        <td class="source">    if (v[1] < index) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">32</td>
                        <td class="hits">25</td>
                        <td class="source">      ext = v[0];</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">33</td>
                        <td class="hits">25</td>
                        <td class="source">      index = v[1];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">34</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">35</td>
                        <td class="hits"></td>
                        <td class="source">  });</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">36</td>
                        <td class="hits">25</td>
                        <td class="source">  return ext;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">37</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">38</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">39</td>
                        <td class="hits">1</td>
                        <td class="source">exports.seekFile = function(cube, root, qpath, ps, callback) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">40</td>
                        <td class="hits">32</td>
                        <td class="source">  var origFile = path.join(root, qpath);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">41</td>
                        <td class="hits">32</td>
                        <td class="source">  var origExt = path.extname(qpath);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">42</td>
                        <td class="hits">32</td>
                        <td class="source">  var fPath = path.dirname(qpath);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">43</td>
                        <td class="hits">32</td>
                        <td class="source">  var fName = path.basename(qpath, origExt);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">44</td>
                        <td class="hits">32</td>
                        <td class="source">  var dir = path.join(root, fPath);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">45</td>
                        <td class="hits"></td>
                        <td class="source">  if (fs.existsSync(origFile)) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">46</td>
                        <td class="hits">21</td>
                        <td class="source">    return callback(null, qpath, origExt, ps ? ps[origExt] : <i class="cond-miss">undefined</i>);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">47</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">48</td>
                        <td class="hits">11</td>
                        <td class="source">  var type = cube.processors.map[origExt];</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">49</td>
                        <td class="hits">11</td>
                        <td class="source">  var possibleExts = Object.keys(cube.processors.types[type]);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">50</td>
                        <td class="hits">11</td>
                        <td class="source">  debug('seekFile, type: %s ,qpath: %s, possibleExts: %s', type, qpath, possibleExts);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">51</td>
                        <td class="hits">11</td>
                        <td class="source">  fs.readdir(dir, function (err, arr) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">52</td>
                        <td class="hits"></td>
                        <td class="source">    if (err) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">53</td>
                        <td class="hits">0</td>
                        <td class="source">      return callback(err, null);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">54</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">55</td>
                        <td class="hits">11</td>
                        <td class="source">    var targetExt = exports.traverseFList(arr, fName, possibleExts);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">56</td>
                        <td class="hits"></td>
                        <td class="source">    if (targetExt instanceof Error) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">57</td>
                        <td class="hits">2</td>
                        <td class="source">      targetExt.message = 'file not found: ' + qpath;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">58</td>
                        <td class="hits">2</td>
                        <td class="source">      return callback(targetExt);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">59</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">60</td>
                        <td class="hits">9</td>
                        <td class="source">    return callback(null, fPath + '/' + fName + targetExt, targetExt, ps ? ps[targetExt] : <i class="cond-miss">undefined</i>);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">61</td>
                        <td class="hits"></td>
                        <td class="source">  });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">62</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">63</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">64</td>
                        <td class="hits">1</td>
                        <td class="source">exports.merge = function (target, source) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">65</td>
                        <td class="hits">0</td>
                        <td class="source">  Object.keys(source).forEach(function (key) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">66</td>
                        <td class="hits">0</td>
                        <td class="source">    target[key] = source[key];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">67</td>
                        <td class="hits"></td>
                        <td class="source">  });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">68</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">69</td>
                        <td class="hits"></td>
                        <td class="source">/**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">70</td>
                        <td class="hits"></td>
                        <td class="source"> * update module name change</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">71</td>
                        <td class="hits"></td>
                        <td class="source"> * @param  {Path} file      the require filename</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">72</td>
                        <td class="hits"></td>
                        <td class="source"> * @param  {Boolean} ifRelease two model: dev or release</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">73</td>
                        <td class="hits"></td>
                        <td class="source"> * @return {Path} targetFileName</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">74</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">75</td>
                        <td class="hits">1</td>
                        <td class="source">exports.moduleName = function(file, type, ifRelease) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">76</td>
                        <td class="hits"></td>
                        <td class="source">  if (!ifRelease) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">77</td>
                        <td class="hits">44</td>
                        <td class="source">    return file;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">78</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">79</td>
                        <td class="hits"></td>
                        <td class="source">  if (<i class="cond-miss">type === 'script'</i>) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">80</td>
                        <td class="hits"></td>
                        <td class="source">    // change all script type to .js file</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">81</td>
                        <td class="hits">0</td>
                        <td class="source">    file = file.replace(/\.\w+$/, '.js');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">82</td>
                        <td class="hits"></td>
                        <td class="source">  } else if (<i class="cond-miss">type === 'style'</i>) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">83</td>
                        <td class="hits"></td>
                        <td class="source">    // add .js suffix to style file</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">84</td>
                        <td class="hits">0</td>
                        <td class="source">    file = file + '.js';</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">85</td>
                        <td class="hits"></td>
                        <td class="source">  } else if (<i class="cond-miss">type === 'template'</i>) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">86</td>
                        <td class="hits"></td>
                        <td class="source">    // add .js suffix to template file</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">87</td>
                        <td class="hits">0</td>
                        <td class="source">    file = file + '.js';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">88</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">89</td>
                        <td class="hits">0</td>
                        <td class="source">  return file;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">90</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
        <div class="file">
            <h2 id="runtime/cube_css.js"> runtime/cube_css.js</h2>
            <div id="stats">
              <div class="linecoverage">
                <span class="linecov high">
                  [100%]
                </span>
                <span>18/18<span>
                <span class="misses">
                  0
                </span>
              </div>
              <div class="branchcoverage">
                <span class="branchcov high">
                  [100%]
                </span>
                <span>3/3</span>
                <span class="misses">
                  0
                </span>
              </div>
            </div>
            <table id="source">
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              </thead>
              <tbody>
                
                
                
                  
                  
                      <tr class="hit">
                        <td class="line">1</td>
                        <td class="hits">1</td>
                        <td class="source">!(function (Cube) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">2</td>
                        <td class="hits">1</td>
                        <td class="source">var parseCssRe = /\}\n?([\s\S]*?)\{/g;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">3</td>
                        <td class="hits">1</td>
                        <td class="source">Cube.css = function (css, namespace, file) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">4</td>
                        <td class="hits"></td>
                        <td class="source">  if (!css) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">5</td>
                        <td class="hits">1</td>
                        <td class="source">    return;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">6</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">7</td>
                        <td class="hits"></td>
                        <td class="source">  if (namespace) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">8</td>
                        <td class="hits">3</td>
                        <td class="source">    css = '}' + css;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">9</td>
                        <td class="hits">3</td>
                        <td class="source">    css = css.replace(parseCssRe, function (match, p1, offset, string) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">10</td>
                        <td class="hits">3</td>
                        <td class="source">      var selectors = p1.split(',').map(function (selector) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">11</td>
                        <td class="hits">5</td>
                        <td class="source">        return namespace + ' ' + selector.trim();</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">12</td>
                        <td class="hits"></td>
                        <td class="source">      });</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">13</td>
                        <td class="hits">3</td>
                        <td class="source">      selectors = selectors.join(',');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">14</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">15</td>
                        <td class="hits">3</td>
                        <td class="source">      return '}\n' + selectors + '{';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">16</td>
                        <td class="hits"></td>
                        <td class="source">    });</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">17</td>
                        <td class="hits">3</td>
                        <td class="source">    css = css.slice(1);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">18</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">19</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">20</td>
                        <td class="hits">4</td>
                        <td class="source">  var headNode = document.getElementsByTagName('HEAD')[0];</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">21</td>
                        <td class="hits">4</td>
                        <td class="source">  var style = document.createElement('style');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">22</td>
                        <td class="hits">4</td>
                        <td class="source">  style.setAttribute('type', 'text/css');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">23</td>
                        <td class="hits">4</td>
                        <td class="source">  style.setAttribute('mod', file);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">24</td>
                        <td class="hits"></td>
                        <td class="source">  if (namespace) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">25</td>
                        <td class="hits">3</td>
                        <td class="source">    style.setAttribute('ns', namespace);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">26</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">27</td>
                        <td class="hits">4</td>
                        <td class="source">  headNode.appendChild(style);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">28</td>
                        <td class="hits">4</td>
                        <td class="source">  style.innerHTML = css;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">29</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">30</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">31</td>
                        <td class="hits"></td>
                        <td class="source">})(Cube);</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
        <div class="file">
            <h2 id="service.js"> service.js</h2>
            <div id="stats">
              <div class="linecoverage">
                <span class="linecov medium">
                  [85%]
                </span>
                <span>79/92<span>
                <span class="misses">
                  13
                </span>
              </div>
              <div class="branchcoverage">
                <span class="branchcov medium">
                  [80%]
                </span>
                <span>36/45</span>
                <span class="misses">
                  9
                </span>
              </div>
            </div>
            <table id="source">
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              </thead>
              <tbody>
                
                
                
                  
                  
                      <tr>
                        <td class="line">1</td>
                        <td class="hits"></td>
                        <td class="source">/*!</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">2</td>
                        <td class="hits"></td>
                        <td class="source"> * Cube services, start a http server, or return a middleware</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">3</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">4</td>
                        <td class="hits">1</td>
                        <td class="source">var xfs = require('xfs');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">5</td>
                        <td class="hits">1</td>
                        <td class="source">var debug = require('debug')('cube');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">6</td>
                        <td class="hits">1</td>
                        <td class="source">var url = require('url');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">7</td>
                        <td class="hits">1</td>
                        <td class="source">var qs = require('querystring');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">8</td>
                        <td class="hits">1</td>
                        <td class="source">var path = require('path');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">9</td>
                        <td class="hits">1</td>
                        <td class="source">var connect = require('connect');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">10</td>
                        <td class="hits">1</td>
                        <td class="source">var connectStatic = require('serve-static');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">11</td>
                        <td class="hits">1</td>
                        <td class="source">var utils = require('./lib/utils');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">12</td>
                        <td class="hits">1</td>
                        <td class="source">var Event = require('events').EventEmitter;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">13</td>
                        <td class="hits"></td>
                        <td class="source">/**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">14</td>
                        <td class="hits"></td>
                        <td class="source"> * CACHE {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">15</td>
                        <td class="hits"></td>
                        <td class="source"> *   realPath: {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">16</td>
                        <td class="hits"></td>
                        <td class="source"> *     mtime:</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">17</td>
                        <td class="hits"></td>
                        <td class="source"> *     mime:</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">18</td>
                        <td class="hits"></td>
                        <td class="source"> *     code:</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">19</td>
                        <td class="hits"></td>
                        <td class="source"> *   }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">20</td>
                        <td class="hits"></td>
                        <td class="source"> * }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">21</td>
                        <td class="hits"></td>
                        <td class="source"> * @type {Object}</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">22</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">23</td>
                        <td class="hits">1</td>
                        <td class="source">var CACHE = {};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">24</td>
                        <td class="hits"></td>
                        <td class="source">/**</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">25</td>
                        <td class="hits"></td>
                        <td class="source"> * init cube</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">26</td>
                        <td class="hits"></td>
                        <td class="source"> *</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">27</td>
                        <td class="hits"></td>
                        <td class="source"> * @param  {Object} config</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">28</td>
                        <td class="hits"></td>
                        <td class="source"> *         - port       listen port [optional]</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">29</td>
                        <td class="hits"></td>
                        <td class="source"> *         - connect    the connect object</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">30</td>
                        <td class="hits"></td>
                        <td class="source"> *         - root       static root</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">31</td>
                        <td class="hits"></td>
                        <td class="source"> *         - router     http path</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">32</td>
                        <td class="hits"></td>
                        <td class="source"> *         - middleware  boolean, default false</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">33</td>
                        <td class="hits"></td>
                        <td class="source"> */</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">34</td>
                        <td class="hits">1</td>
                        <td class="source">exports.init = function (cube, config) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">35</td>
                        <td class="hits"></td>
                        <td class="source">  if (config.middleware === undefined) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">36</td>
                        <td class="hits">0</td>
                        <td class="source">    config.middleware = false;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">37</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">38</td>
                        <td class="hits">1</td>
                        <td class="source">  var root = cube.config.root;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">39</td>
                        <td class="hits">1</td>
                        <td class="source">  var serveStatic;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">40</td>
                        <td class="hits">1</td>
                        <td class="source">  var app;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">41</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">42</td>
                        <td class="hits">1</td>
                        <td class="source">  config.cached = config.cached ? <i class="cond-miss">config.cached</i> : root + '.release';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">43</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">44</td>
                        <td class="hits"></td>
                        <td class="source">  if (!xfs.existsSync(config.cached)) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">45</td>
                        <td class="hits">1</td>
                        <td class="source">    config.cached = false;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">46</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">47</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">48</td>
                        <td class="hits">1</td>
                        <td class="source">  config.maxAge = config.maxAge && <i class="cond-miss">config.cached</i> ? <i class="cond-miss">config.maxAge</i> : 0;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">49</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">50</td>
                        <td class="hits">1</td>
                        <td class="source">  serveStatic = connectStatic(config.cached ? <i class="cond-miss">config.cached</i> : config.root, {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">51</td>
                        <td class="hits"></td>
                        <td class="source">    maxAge: config.maxAge</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">52</td>
                        <td class="hits"></td>
                        <td class="source">  });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">53</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">54</td>
                        <td class="hits"></td>
                        <td class="source">  function processQuery(req, res, next) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">55</td>
                        <td class="hits">32</td>
                        <td class="source">    var q = url.parse(req.url, true);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">56</td>
                        <td class="hits">32</td>
                        <td class="source">    var qpath = q.pathname;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">57</td>
                        <td class="hits">32</td>
                        <td class="source">    var ext = path.extname(qpath);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">58</td>
                        <td class="hits">32</td>
                        <td class="source">    var cachePath;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">59</td>
                        <td class="hits"></td>
                        <td class="source">    if (qpath === '/') {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">60</td>
                        <td class="hits">0</td>
                        <td class="source">      req.url = '/index.html';</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">61</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">62</td>
                        <td class="hits"></td>
                        <td class="source">    // parse query object</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">63</td>
                        <td class="hits"></td>
                        <td class="source">    if (!req.query) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">64</td>
                        <td class="hits">32</td>
                        <td class="source">      var originalUrl = req.originalUrl;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">65</td>
                        <td class="hits">32</td>
                        <td class="source">      originalUrl = originalUrl ? originalUrl : <i class="cond-miss">req.url</i>;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">66</td>
                        <td class="hits">32</td>
                        <td class="source">      var queryString = url.parse(originalUrl).query;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">67</td>
                        <td class="hits">32</td>
                        <td class="source">      req.query = qs.parse(queryString);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">68</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">69</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">70</td>
                        <td class="hits">32</td>
                        <td class="source">    debug('query file', qpath);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">71</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">72</td>
                        <td class="hits">32</td>
                        <td class="source">    var type =  cube.processors.map[ext];</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">73</td>
                        <td class="hits"></td>
                        <td class="source">    if (type === undefined) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">74</td>
                        <td class="hits">0</td>
                        <td class="source">      debug('unknow file type, query will passed to connect.static handler');</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">75</td>
                        <td class="hits">0</td>
                        <td class="source">      return serveStatic(req, res, next);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">76</td>
                        <td class="hits"></td>
                        <td class="source">    }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">77</td>
                        <td class="hits">32</td>
                        <td class="source">    var mime = cube.getMIMEType(type);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">78</td>
                        <td class="hits">32</td>
                        <td class="source">    var ps = cube.processors.types[type];</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">79</td>
                        <td class="hits">32</td>
                        <td class="source">    var options = {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">80</td>
                        <td class="hits"></td>
                        <td class="source">      root: root,</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">81</td>
                        <td class="hits"></td>
                        <td class="source">      moduleWrap: req.query.m === undefined ? false : true,</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">82</td>
                        <td class="hits"></td>
                        <td class="source">      sourceMap: false,</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">83</td>
                        <td class="hits"></td>
                        <td class="source">      compress: req.query.c === undefined ? false : true,</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">84</td>
                        <td class="hits"></td>
                        <td class="source">      qpath: qpath</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">85</td>
                        <td class="hits"></td>
                        <td class="source">    };</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">86</td>
                        <td class="hits">32</td>
                        <td class="source">    cachePath = qpath + ':' + options.moduleWrap + ':' + options.compress;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">87</td>
                        <td class="hits">32</td>
                        <td class="source">    debug('recognize file type: %s', type);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">88</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">89</td>
                        <td class="hits">32</td>
                        <td class="source">    var evt = new Event();</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">90</td>
                        <td class="hits">32</td>
                        <td class="source">    var origEtag = req.headers.etag;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">91</td>
                        <td class="hits">32</td>
                        <td class="source">    var realPath;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">92</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">93</td>
                        <td class="hits">32</td>
                        <td class="source">    evt.on('error', function (code, msg) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">94</td>
                        <td class="hits">3</td>
                        <td class="source">      res.statusCode = code || 500;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">95</td>
                        <td class="hits">3</td>
                        <td class="source">      res.end(msg || 'server error');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">96</td>
                        <td class="hits"></td>
                        <td class="source">    });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">97</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">98</td>
                        <td class="hits">32</td>
                        <td class="source">    evt.on('seekfile', function (rpath, processor) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">99</td>
                        <td class="hits">30</td>
                        <td class="source">      var tmp = CACHE[cachePath];</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">100</td>
                        <td class="hits">30</td>
                        <td class="source">      realPath = rpath;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">101</td>
                        <td class="hits">30</td>
                        <td class="source">      xfs.lstat(path.join(options.root, rpath), function (err, stats) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">102</td>
                        <td class="hits"></td>
                        <td class="source">        if (err) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">103</td>
                        <td class="hits">0</td>
                        <td class="source">          return evt.emit('error', 500, 'read file stats error:' + err.message);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">104</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">105</td>
                        <td class="hits">30</td>
                        <td class="source">        var mtime = new Date(stats.mtime).getTime();</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">106</td>
                        <td class="hits"></td>
                        <td class="source">        if (tmp) { // if cached, check cache</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">107</td>
                        <td class="hits"></td>
                        <td class="source">          if (<i class="cond-miss">tmp.mtime === mtime</i>) { // target the cache, just return</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">108</td>
                        <td class="hits">0</td>
                        <td class="source">            debug('hint cache', realPath);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">109</td>
                        <td class="hits">0</td>
                        <td class="source">            evt.emit('end', tmp.mime, tmp.code);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">110</td>
                        <td class="hits"></td>
                        <td class="source">          } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">111</td>
                        <td class="hits">0</td>
                        <td class="source">            evt.emit('process', rpath, processor, mtime);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">112</td>
                        <td class="hits"></td>
                        <td class="source">          }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">113</td>
                        <td class="hits"></td>
                        <td class="source">        } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">114</td>
                        <td class="hits">30</td>
                        <td class="source">          evt.emit('process', rpath, processor, mtime);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">115</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">116</td>
                        <td class="hits"></td>
                        <td class="source">      });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">117</td>
                        <td class="hits"></td>
                        <td class="source">    });</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">118</td>
                        <td class="hits">32</td>
                        <td class="source">    evt.on('process', function (realPath, processor, mtime) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">119</td>
                        <td class="hits">30</td>
                        <td class="source">      processor.process(realPath, options, function (err, result) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">120</td>
                        <td class="hits"></td>
                        <td class="source">        if (err) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">121</td>
                        <td class="hits">1</td>
                        <td class="source">          debug('[ERROR]: %s %s %s', err.code, err.message, err.stack);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">122</td>
                        <td class="hits"></td>
                        <td class="source">          if (options.moduleWrap) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">123</td>
                        <td class="hits">1</td>
                        <td class="source">            evt.emit('error', 200, 'console.error("[CUBE]",' + JSON.stringify(err.message) + ');');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">124</td>
                        <td class="hits"></td>
                        <td class="source">          } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">125</td>
                        <td class="hits">0</td>
                        <td class="source">            evt.emit('error', 500, err.message);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">126</td>
                        <td class="hits"></td>
                        <td class="source">          }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">127</td>
                        <td class="hits">1</td>
                        <td class="source">          return;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">128</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">129</td>
                        <td class="hits">29</td>
                        <td class="source">        evt.emit('processEnd', result, mtime);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">130</td>
                        <td class="hits"></td>
                        <td class="source">      });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">131</td>
                        <td class="hits"></td>
                        <td class="source">    });</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">132</td>
                        <td class="hits">32</td>
                        <td class="source">    evt.on('processEnd', function (result, mtime) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">133</td>
                        <td class="hits">29</td>
                        <td class="source">      var code;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">134</td>
                        <td class="hits"></td>
                        <td class="source">      if (options.moduleWrap) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">135</td>
                        <td class="hits">17</td>
                        <td class="source">        code = result.wraped !== undefined ? result.wraped : result.code;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">136</td>
                        <td class="hits">17</td>
                        <td class="source">        mime = cube.getMIMEType('script');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">137</td>
                        <td class="hits"></td>
                        <td class="source">      } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">138</td>
                        <td class="hits"></td>
                        <td class="source">        if (options.compress) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">139</td>
                        <td class="hits">6</td>
                        <td class="source">          code = result.code;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">140</td>
                        <td class="hits"></td>
                        <td class="source">        } else if (realPath === qpath) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">141</td>
                        <td class="hits">5</td>
                        <td class="source">          code = result.source;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">142</td>
                        <td class="hits"></td>
                        <td class="source">        } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">143</td>
                        <td class="hits">1</td>
                        <td class="source">          code = result.code;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">144</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">145</td>
                        <td class="hits"></td>
                        <td class="source">      }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">146</td>
                        <td class="hits"></td>
                        <td class="source">      if (cube.config.devCache) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">147</td>
                        <td class="hits">29</td>
                        <td class="source">        debug('cache processed file: %s, %s' + realPath, mtime);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">148</td>
                        <td class="hits">29</td>
                        <td class="source">        CACHE[cachePath] = {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">149</td>
                        <td class="hits"></td>
                        <td class="source">          mtime: mtime,</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">150</td>
                        <td class="hits"></td>
                        <td class="source">          mime: mime,</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">151</td>
                        <td class="hits"></td>
                        <td class="source">          code: code</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">152</td>
                        <td class="hits"></td>
                        <td class="source">        };</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">153</td>
                        <td class="hits"></td>
                        <td class="source">      }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">154</td>
                        <td class="hits">29</td>
                        <td class="source">      evt.emit('end', mime, code);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">155</td>
                        <td class="hits"></td>
                        <td class="source">    });</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">156</td>
                        <td class="hits">32</td>
                        <td class="source">    evt.on('end', function (mime, code) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">157</td>
                        <td class="hits">29</td>
                        <td class="source">      res.statusCode = 200;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">158</td>
                        <td class="hits">29</td>
                        <td class="source">      res.setHeader('content-type', mime); // fix #10</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">159</td>
                        <td class="hits">29</td>
                        <td class="source">      res.end(code);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">160</td>
                        <td class="hits"></td>
                        <td class="source">    });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">161</td>
                        <td class="hits"></td>
                        <td class="source">    // seek for realpath</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">162</td>
                        <td class="hits">32</td>
                        <td class="source">    utils.seekFile(cube, root, qpath, ps, function (err, realPath, ext, processor) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">163</td>
                        <td class="hits"></td>
                        <td class="source">      if (err) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">164</td>
                        <td class="hits">2</td>
                        <td class="source">        debug('seek file error', err, options);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">165</td>
                        <td class="hits"></td>
                        <td class="source">        if (type === 'script' && options.moduleWrap) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">166</td>
                        <td class="hits">1</td>
                        <td class="source">          res.setHeader('content-type', mime);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">167</td>
                        <td class="hits">1</td>
                        <td class="source">          evt.emit('error', 200, 'console.error("[CUBE]",' + JSON.stringify(err.stack) + ');');</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">168</td>
                        <td class="hits"></td>
                        <td class="source">        } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">169</td>
                        <td class="hits">1</td>
                        <td class="source">          evt.emit('error', 404, 'file not found:' + qpath);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">170</td>
                        <td class="hits"></td>
                        <td class="source">        }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">171</td>
                        <td class="hits">2</td>
                        <td class="source">        return ;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">172</td>
                        <td class="hits"></td>
                        <td class="source">      }</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">173</td>
                        <td class="hits">30</td>
                        <td class="source">      debug('query: %s target: %s type: %s %s', qpath, realPath, type, cube.mimeType[type]);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">174</td>
                        <td class="hits">30</td>
                        <td class="source">      evt.emit('seekfile', realPath, processor);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">175</td>
                        <td class="hits"></td>
                        <td class="source">    });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">176</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">177</td>
                        <td class="hits"></td>
                        <td class="source">  // return middleware</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">178</td>
                        <td class="hits"></td>
                        <td class="source">  if (config.middleware) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">179</td>
                        <td class="hits">0</td>
                        <td class="source">    cube.middleware = config.cached ? <i class="cond-miss">serveStatic</i> : <i class="cond-miss">processQuery</i>;</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">180</td>
                        <td class="hits">0</td>
                        <td class="source">    cube.middleware.getCube = function () {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">181</td>
                        <td class="hits">0</td>
                        <td class="source">      return cube;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">182</td>
                        <td class="hits"></td>
                        <td class="source">    };</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">183</td>
                        <td class="hits"></td>
                        <td class="source">  } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">184</td>
                        <td class="hits">1</td>
                        <td class="source">    app = connect();</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss-branch">
                        <td class="line">185</td>
                        <td class="hits">1</td>
                        <td class="source">    app.use(config.router, config.cached ? <i class="cond-miss">serveStatic</i> : processQuery);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">186</td>
                        <td class="hits">1</td>
                        <td class="source">    cube.connect = app;</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">187</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">188</td>
                        <td class="hits"></td>
                        <td class="source">  // other static files</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">189</td>
                        <td class="hits"></td>
                        <td class="source">  if (!config.middleware && config.port) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">190</td>
                        <td class="hits">1</td>
                        <td class="source">    app.listen(config.port, function (err) {</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">191</td>
                        <td class="hits"></td>
                        <td class="source">      if (err) {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="miss">
                        <td class="line">192</td>
                        <td class="hits">0</td>
                        <td class="source">        console.error('[Cube] server fail to start,', err.message);</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">193</td>
                        <td class="hits"></td>
                        <td class="source">      } else {</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">194</td>
                        <td class="hits">1</td>
                        <td class="source">        console.log('[Cube] server started, listen:', config.port);</td>
                      </tr>
                  
                
                  
                  
                      <tr class="hit">
                        <td class="line">195</td>
                        <td class="hits">1</td>
                        <td class="source">        console.log('[Cube] visit: http://localhost:' + config.port + path.join(config.router, '/index.html').replace(/\\/g, '/'));</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">196</td>
                        <td class="hits"></td>
                        <td class="source">      }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">197</td>
                        <td class="hits"></td>
                        <td class="source">    });</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">198</td>
                        <td class="hits"></td>
                        <td class="source">  }</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">199</td>
                        <td class="hits"></td>
                        <td class="source">};</td>
                      </tr>
                  
                
                  
                  
                      <tr>
                        <td class="line">200</td>
                        <td class="hits"></td>
                        <td class="source"></td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
      </div>
    </div>
  </body>
</html>
