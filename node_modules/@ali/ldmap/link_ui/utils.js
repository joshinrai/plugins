'use strict';
var $ = require('jquery');

///
var funcIndex = 0;
//{argus:[],
function createFunction(options){
  var scriptStart= '<script type="text/javascript">';
  var funcName = _getFuncName();
  var funcStart = 'window.' + funcName + ' = function(';
  var argus = '', inputs = options.inputs;
  for(var i in inputs){
    argus += inputs[i]
    if(i!= (inputs.length -1)) argus += ',';
  }
  var funcBody = '){' + options.body +'};';
  var scriptEnd= '</script>';
  var funcTEXT =  scriptStart + funcStart + argus + funcBody + scriptEnd;
  try{
    $(funcTEXT).appendTo($('body'));
    return window[funcName];
  } catch(e){
    return e.toString();
  }
};

function _getFuncName () {
  return 'func_' + (new Date().getTime()) + '_' + funcIndex++;
}
//

module.exports = {
  createFunction: createFunction
};
