"use strict";
var L = require('leaflet');
var dmap = L.dmap = L.dmap || {};
var IconFont = dmap.IconFont = L.Icon.extend({
  options: {
    'iconSize': [35, 45],
    'iconAnchor': [17, 42],
    'popupAnchor': [1, -32],
    'shadowAnchor': [10, 12],
    'shadowSize': [6, 6],
    'opacity': 0.9,
    'textShadow': '2px 2px 2px #000',
    'className': 'fa flaticon-aim5',
    'extraClasses': '',
    'fontSize': 20,
    'icon': 'home',
    'iconColor': 'rgba(255,150,50,1)',
    'processing': null
  },

  initialize: function(options) {
    options = L.Util.setOptions(this, options);
  },

  createIcon: function() {
    var div = this.divIcon = document.createElement('div'),
      options = this.options;
    if (options.icon) {
      div.innerHTML = this._createInner();
    }
    if(options.processing){
      options.processing(div);
    }
    return div;
  },
  data: function(){
  },
  updateCount: function(count){
    $(this.divIcon).text(count)
  },

  _createInner: function() {
    var options = this.options;
    var iconSize = options.iconSize;
    var style = 'position:absolute;text-align:center;display:inline;margin:0;padding:0;transform:translate(-50%,-50%);-webkit-transform:translate(-50%,-50%);' +
    'color: ' + options.iconColor + ';' +
    'font-size:'+options.fontSize + 'px;' + 
    'opacity:' + options.opacity  + ';' +
    'text-shadow:' + options.textShadow  + ';' + 
    'width:' + iconSize[0] + 'px;'; 
    return '<i class="' + options.className + '" style="' + style + '"></i>'
  }
});

dmap.iconFont = function(options) {
  return new dmap.IconFont(options);
};

module.exports = IconFont;

