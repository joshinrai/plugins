function Pie(t,e){var r={arc:{innerRadius:0,outerRadius:0,padRadius:0,cornerRadius:0,startAngle:function(t){return t.startAngle},endAngle:function(t){return t.endAngle},padAngle:0}};r=_.deepMerge(r,e),DataV.call(this,t,r)}require("./pie.css");var DataV=require("../datav"),d3=require("d3"),_=require("../util");Pie=DataV.extend(Pie,{data:function(t){if(!t)return this._data;var e=this.options.yaxis.key;t.sort(function(t,r){return r[e]-t[e]}),this._data=t,this._data=t},renderSeries:function(){this.svg.classed("pie-chart-g",!0);var t=this.options,e=this.data(),r=t.arc.radius=Math.min(t.innerHeight,t.innerWidth)/2;t.arc.outerRadius=function(t,e){return r-15*(e+1)};var a=this.renderCom("arc","arc",this.svg[0][0],t.arc).getArc(),i=d3.layout.pie().sort(null).value(function(){return 1});this.series=this.svg.selectAll(".pie").data(i(e)).enter().append("g").attr("class","arc").attr("transform","translate("+t.innerWidth/2+","+t.innerHeight/2+")").each(function(e,r){var i=d3.select(this);i.append("path").attr({"class":"pie pie"+(r+1),d:function(e){var i=a(e,r),n=i.match(/[-+]?[0-9]*\.?[0-9]+e?[-+]?[0-9]*/g);return n.splice(2,5),"function"==typeof t.customPos&&(n=t.customPos(n)),_.pos2PathByArr(n)}}),i.append("text").attr({"class":"pie-label",transform:function(e){if(!t.xaxis.dr)return"translate("+a.centroid(e,r)+")";var i=t.xaxis.dr,n=(t.arc.startAngle(e)+t.arc.endAngle(e))/2,s=a.centroid(e,r),o=s[0],c=s[1];return"translate("+(o+i*Math.sin(n))+", "+(c-i*Math.cos(n))+")"},dy:".35em"}).style("text-anchor","middle").text(function(e){return e.data[t.xaxis.key]})}),t.withInteract&&this.series.on("click",function(t,e){self.emit("series_click",{data:t,index:e,dom:this})}).on("mouseenter",function(t,e){self.emit("series_mouseenter",{data:t,index:e,dom:this})}).on("mouseover",function(t,e){self.emit("series_mouseover",{data:t,index:e,dom:this})}).on("mouseleave",function(t,e){self.emit("series_mouseleave",{data:t,index:e,dom:this})})},updateSeries:function(){var t=this.options,e=this.data(),r=t.arc.radius=Math.min(t.innerHeight,t.innerWidth)/2;t.arc.outerRadius=function(t,e){return r-15*(e+1)};var a=this.getComs("arc","arc");a.update(e,t.arc),a=a.getArc();var i=d3.layout.pie().sort(null).value(function(){return 1});this.series.data(i(e)),this.series.attr("transform","translate("+t.innerWidth/2+","+t.innerHeight/2+")").each(function(e,r){var i=d3.select(this);i.select(".pie"+(r+1)).attr({d:function(e){var i=a(e,r),n=i.match(/[-+]?[0-9]*\.?[0-9]+e?[-+]?[0-9]*/g);return n.splice(2,5),"function"==typeof t.customPos&&(n=t.customPos(n)),_.pos2PathByArr(n)}}),i.select(".pie-label").attr({transform:function(t){return"translate("+a.centroid(t,r)+")"},dy:".35em"}).style("text-anchor","middle").text(function(e){return e.data[t.xaxis.key]})})}}),module.exports=Pie;