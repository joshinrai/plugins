function Pie(e,t){var r={arc:{innerRadius:0,outerRadius:0,padRadius:0,cornerRadius:0,startAngle:function(e){return e.startAngle},endAngle:function(e){return e.endAngle},padAngle:0},xaxis:{}};r=_.deepMerge(r,t),DataV.call(this,e,r)}require("./pie.css");var DataV=require("../datav"),d3=require("d3"),_=require("../util");Pie=DataV.extend(Pie,{renderSeries:function(){this.svg.classed("pie-chart-g",!0);var e=this.options,t=this.data();e.arc.radius=Math.min(e.innerHeight,e.innerWidth)/2;var r=this.renderCom("arc","arc",this.svg[0][0],e.arc).getArc(),a=d3.layout.pie().sort(null).value(function(t){return t[e.yaxis.key]});this.series=this.svg.selectAll(".pie").data(a(t)).enter().append("g").attr("class","arc").attr("transform","translate("+e.innerWidth/2+","+e.innerHeight/2+")").each(function(t,a){var i=d3.select(this);i.append("path").attr({"class":"pie pie"+(a+1),d:r}),i.append("text").attr({"class":"pie-label",transform:function(t){if(!e.xaxis.dr)return"translate("+r.centroid(t)+")";var a=e.xaxis.dr,i=(e.arc.startAngle(t)+e.arc.endAngle(t))/2,n=r.centroid(t),s=n[0],d=n[1];return"translate("+(s+a*Math.sin(i))+", "+(d-a*Math.cos(i))+")"},dy:".35em"}).style("text-anchor","middle").text(function(t){return t.data[e.xaxis.key]})}),e.withInteract&&this.series.on("click",function(e,t){self.emit("series_click",{data:e,index:t,dom:this})}).on("mouseenter",function(e,t){self.emit("series_mouseenter",{data:e,index:t,dom:this})}).on("mouseover",function(e,t){self.emit("series_mouseover",{data:e,index:t,dom:this})}).on("mouseleave",function(e,t){self.emit("series_mouseleave",{data:e,index:t,dom:this})})},updateSeries:function(){var e=this.options,t=this.data();e.arc.radius=Math.min(e.innerHeight,e.innerWidth)/2;var r=this.getComs("arc","arc");r.update(t,e.arc),r=r.getArc();var a=d3.layout.pie().sort(null).value(function(t){return t[e.yaxis.key]});this.series.data(a(t)),this.series.attr("transform","translate("+e.innerWidth/2+","+e.innerHeight/2+")").each(function(t,a){var i=d3.select(this);i.select(".pie"+(a+1)).attr({d:r}),i.select(".pie-label").attr({transform:function(t){if(!e.dr)return"translate("+r.centroid(t)+")";var a=e.xaxis.dr,i=(e.arc.startAngle(t)+e.arc.endAngle(t))/2,n=r.centroid(t),s=n[0],d=n[1];return"translate("+(s+a*Math.sin(i))+", "+(d-a*Math.cos(i))+")"},dy:".35em"}).style("text-anchor","middle").text(function(t){return t.data[e.xaxis.key]})})}}),module.exports=Pie;