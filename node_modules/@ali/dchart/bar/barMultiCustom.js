function BarMultiCustom(t,e){var a={margin:{top:20,right:20,bottom:20,left:20},xaxis:{type:"category",orient:"bottom",key:"x",groupPadding:[.4,0]},yaxis:{type:"defaults",orient:"left",key:"y",min:0}};_.deepMerge(a,e,1),DataV.call(this,t,a)}require("./bar.css");var DataV=require("../datav"),d3=require("d3"),_=require("../util");BarMultiCustom=DataV.extend(BarMultiCustom,{renderSeries:function(){this.svg.classed("bar-chart-g",!0);var t,e,a=this.options,s=this.data(),i=this,n=a.xaxis.key,r=a.yaxis.key,o=[];s.forEach(function(t){o=_.union(o,t[r])});var u=_.max(o);a.yaxis.max=a.yaxis.max||u,t=this.renderXAxis("xaxis",this.svg[0][0],a.xaxis),e=this.renderYAxis("yaxis",this.svg[0][0],a.yaxis);var d=t.getX(),x=e.getX(),c=s[0][r].length,y=t.calGroupStep(a.groupLabel||s[0][r].length);this.series=this.svg.selectAll(".bars").data(s).enter().append("g").attr("class","bars").each(function(){var t=d3.select(this);if(a.withAnimated)for(var e=0;c>e;e++)!function(e){t.append("polygon").attr({"class":"bar y"+(e+1),points:function(t){var a=[{x:d(t[n])+y(""+e),y:x(0)},{x:d(t[n])+y(""+e),y:x(0)},{x:d(t[n])+y(""+e)+y.rangeBand(),y:x(0)},{x:d(t[n])+y(""+e)+y.rangeBand(),y:x(0)}];return _.pos2Str(a)}}).transition().duration(a.animatedTiming).ease(a.animatedEasing).attr({points:function(t){var s=[{x:d(t[n])+y(""+e),y:x(0)},{x:d(t[n])+y(""+e),y:x(t[r][e])},{x:d(t[n])+y(""+e)+y.rangeBand(),y:x(t[r][e])},{x:d(t[n])+y(""+e)+y.rangeBand(),y:x(0)}];return"function"==typeof a.customPos&&(s=a.customPos(s,e)),_.pos2Str(s)}})}(e);else for(var e=0;c>e;e++)t.append("polygon").attr({"class":"bar y"+(e+1),points:function(t){var s=[{x:d(t[n])+y(""+e),y:x(0)},{x:d(t[n])+y(""+e),y:x(t[r][e])},{x:d(t[n])+y(""+e)+y.rangeBand(),y:x(t[r][e])},{x:d(t[n])+y(""+e)+y.rangeBand(),y:x(0)}];return"function"==typeof a.customPos&&(s=a.customPos(s,e)),_.pos2Str(s)}})}),a.withInteract&&this.series.on("click",function(t,e){i.emit("series_click",{data:t,index:e,dom:this})}).on("mouseenter",function(t,e){i.emit("series_mouseenter",{data:t,index:e,dom:this})}).on("mouseover",function(t,e){i.emit("series_mouseover",{data:t,index:e,dom:this})}).on("mouseleave",function(t,e){i.emit("series_mouseleave",{data:t,index:e,dom:this})})},updateSeries:function(){var t=this.options,e=t.xaxis.key,a=t.yaxis.key,s=this.getComs("axis"),i=s[0],n=s[1],r=_.deepMerge(this.options,{orient:"bottom",key:e},t.xaxis||{}),o=[];this.data.forEach(function(t){o=_.union(o,t[a])});var u=_.max(o),d=_.deepMerge(this.options,{orient:"left",key:t.y,max:u,min:0},t.yaxis||{});i.update(r),n.update(d);var x=i.getX(),c=n.getX(),y=this.data[0][a].length,m=i.getGroupX();this.svg.selectAll(".bars").data(this.data),this.svg.selectAll(".bars").each(function(){for(var s=d3.select(this),i=0;y>i;i++)s.select(".y"+(i+1)).transition().duration(1500).ease("bounce").attr({points:function(s){var n=[{x:x(s[e])+m(""+i),y:c(0)},{x:x(s[e])+m(""+i),y:c(s[a][i])},{x:x(s[e])+m(""+i)+m.rangeBand(),y:c(s[a][i])},{x:x(s[e])+m(""+i)+m.rangeBand(),y:c(0)}];return"function"==typeof t.customPos&&(n=t.customPos(n,i)),_.pos2Str(n)}})})}}),module.exports=BarMultiCustom;