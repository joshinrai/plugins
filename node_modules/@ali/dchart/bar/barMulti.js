function BarMulti(t,e){var i={margin:{top:20,right:20,bottom:20,left:20},xaxis:{type:"category",orient:"bottom",key:"x",groupPadding:[.4,0]},groupLabel:null,yaxis:{type:"defaults",orient:"left",key:"y",min:0}};_.deepMerge(i,e,1),DataV.call(this,t,i)}require("./bar.css");var DataV=require("../datav"),d3=require("d3"),_=require("../util");BarMulti=DataV.extend(BarMulti,{renderSeries:function(){var t=this.options,e=this.data(),i=this,n=t.xaxis.key,a=t.yaxis.key;this.svg.classed("bar-chart-g",!0);var r,s,o=[];e.forEach(function(t){o=_.union(o,t[a])});var u=_.max(o);t.yaxis.max=t.yaxis.max||u,r=this.renderXAxis("xaxis",this.svg[0][0],t.xaxis),s=this.renderYAxis("yaxis",this.svg[0][0],t.yaxis);var c=r.getX(),d=s.getX(),h=e[0][a].length,x=r.calGroupStep(t.groupLabel||e[0][a].length);this.series=this.svg.selectAll(".bars").data(e).enter().append("g").attr("class","bars").each(function(){var e=d3.select(this);if(t.withAnimated)for(var i=0;h>i;i++)!function(i){e.append("rect").attr({"class":"bar y"+(i+1),x:function(t){return c(t[n])+x(""+i)},y:function(){return d(s.getMin())},width:function(){return x.rangeBand()},height:0}).transition().duration(t.animatedTiming).ease(t.animatedEasing).attr({"class":"bar y"+(i+1),x:function(t){return c(t[n])+x(""+i)},y:function(t){return d(t[a][i])},width:function(){return x.rangeBand()},height:function(t){return d(s.getMin())-d(t[a][i])}})}(i);else for(var i=0;h>i;i++)e.append("rect").attr({"class":"bar y"+(i+1),x:function(t){return c(t[n])+x(""+i)},y:function(t){return d(t[a][i])},width:function(){return x.rangeBand()},height:function(t){return d(s.getMin())-d(t[a][i])}})}),t.withInteract&&this.series.on("click",function(t,e){i.emit("series_click",{data:t,index:e,dom:this})}).on("mouseenter",function(t,e){i.emit("series_mouseenter",{data:t,index:e,dom:this})}).on("mouseover",function(t,e){i.emit("series_mouseover",{data:t,index:e,dom:this})}).on("mouseleave",function(t,e){i.emit("series_mouseleave",{data:t,index:e,dom:this})})},updateSeries:function(){var t=this.options,e=this.data(),i=t.xaxis.key,n=t.yaxis.key,a=this.getComs("axis","xaxis"),r=this.getComs("axis","yaxis"),s=[];e.forEach(function(t){s=_.union(s,t[n])});var o=_.max(s);t.yaxis.max=o,a.update(e,t.xaxis),r.update(e,t.yaxis);var u=a.getX(),c=r.getX(),d=e[0][n].length,h=a.getGroupX();this.series.data(e),this.series.each(function(t){for(var e=d3.select(this),a=0;d>a;a++)e.select(".y"+(a+1)).attr({x:function(){return u(t[i])+h(""+a)},y:function(){return c(t[n][a])},width:function(){return h.rangeBand()},height:function(){return c(r.getMin())-c(t[n][a])}})})}}),module.exports=BarMulti;